{"version":3,"sources":["img.jpg","GlobalStyle.styles.js","components/OptionBox.react.js","../../src/interfaces/enums/CursorType.ts","../../src/interfaces/enums/LabelType.ts","../../src/interfaces/enums/PopupWindowType.ts","../../src/interfaces/enums/EventType.ts","../../src/store/Actions.ts","../../src/store/general/actionCreators.ts","../../src/settings/ViewPointSettings.ts","../../src/store/general/reducer.ts","../../src/store/labels/reducer.ts","../../src/store/index.ts","../../src/components/Icons/index.ts","../../src/components/Icons/Icon.tsx","../../src/model/EditorModel.ts","../../src/interfaces/enums/Direction.ts","../../src/store/selectors/GeneralSelector.ts","../../src/utils/DirectionUtil.ts","../../src/utils/ImageUtil.ts","../../src/utils/NumberUtil.ts","../../src/utils/PointUtil.ts","../../src/utils/RectUtil.ts","../../src/utils/SizeUtil.ts","../../src/logic/actions/ViewPortActions.ts","../../src/utils/MouseEventUtil.ts","../../src/logic/helpers/ViewPortHelper.ts","../../src/settings/Settings.ts","../../src/settings/RenderEngineConfig.ts","../../src/store/labels/actionCreators.ts","../../src/store/selectors/LabelsSelector.ts","../../src/utils/UnitUtil.ts","../../src/utils/DrawUtil.ts","../../src/utils/LineUtil.ts","../../src/utils/RenderEngineUtil.ts","../../node_modules/uuid/lib/bytesToUuid.js","../../node_modules/uuid/lib/rng-browser.js","../../node_modules/uuid/v1.js","../../node_modules/uuid/v4.js","../../node_modules/uuid/index.js","../../src/logic/render/BaseRenderEngine.ts","../../src/logic/render/PolygonRenderEngine.ts","../../src/logic/render/PrimaryEditorRenderEngine.ts","../../src/logic/render/RectRenderEngine.ts","../../src/utils/CanvasUtil.ts","../../src/logic/actions/EditorActions.ts","../../src/utils/FileUtil.ts","../../src/hooks/useCanvasListeners.ts","../../src/hooks/useCanvasZoom.ts","../../src/components/CanvasAnnotation.tsx","../../src/index.tsx","components/TypePicker.react.js","App.js","utils.js","index.js"],"names":["module","exports","GlobalStyle","createGlobalStyle","NOOP","OptionBox","className","children","onClick","isPressed","disabled","Container","styled","button","ifProp","updateCustomCursorStyle","customCursorStyle","type","Action","payload","CursorType","LabelType","PopupWindowType","EventType","ViewPointSettings","initialState","windowSize","preventCustomCursor","imageDragMode","zoom","MIN_ZOOM","activeLabelNameId","activeLabelType","activeLabelId","highlightedLabelId","imageData","rootReducer","combineReducers","general","state","action","labels","fileData","store","createStore","window","AppInitializer","width","height","innerHeight","crosshair","IconPaths","SVG","Icon","d","props","viewBox","EditorModel","GeneralSelector","Direction","DirectionUtil","x","y","ImageUtil","image","NumberUtil","value","min","max","PointUtil","p1","p2","factor","Math","RectUtil","rect","r1","r2","point","centerPoint","size","innerRectHeight","containerRect","innerRectWidth","delta","scale","position","SizeUtil","ViewPortActions","offsetHeight","minMargin","CANVAS_MIN_MARGIN_PX","realImageRect","viewPortWithMarginRect","viewPortWithoutMarginRect","defaultViewPortImageRect","scaledImageSize","viewPortContentSize","newCanvasSize","viewPortSize","relativePosition","values","top","scrollTop","directionVector","translationVector","currentScrollPosition","nextScrollPosition","EditorActions","currentZoom","MouseEventUtil","event","ViewPortHelper","update","data","this","mouseDownHandler","screenY","mouseUpHandler","mouseMoveHandler","currentMousePosition","mousePositionDelta","Settings","RenderEngineConfig","lineThickness","lineActiveColor","lineInactiveColor","anchorSize","RESIZE_HANDLE_DIMENSION_PX","anchorHoverSize","RESIZE_HANDLE_HOVER_DIMENSION_PX","suggestedAnchorDetectionSize","activeAnchorColor","updateActiveLabelId","updateHighlightedLabelId","updateImageData","LabelsSelector","find","id","UnitUtil","angleDeg","angleRad","DrawUtil","canvas","ctx","color","thickness","startPoint","endPoint","startAngleRad","endAngleRad","anchorPoint","anchors","i","bold","align","r","parseInt","hex","g","b","alpha","LineUtil","l","p","RenderEngineUtil","polygon","translation","topLeft","bottomRight","topLeftBetweenPixels","bottomRightBetweenPixels","getRandomValues","crypto","bind","msCrypto","rnds8","Uint8Array","rnds","Array","random","byteToHex","toString","substr","_nodeId","_clockseq","buf","offset","bth","join","_lastMSecs","_lastNSecs","options","node","clockseq","undefined","seedBytes","rng","msecs","Date","getTime","nsecs","dt","Error","tl","tmh","n","bytesToUuid","ii","uuid","v4","v1","BaseRenderEngine","PolygonRenderEngine","config","activePath","resizeAnchorIndex","suggestedAnchorPositionOnCanvas","suggestedAnchorIndexInPolygon","isMouseOverAnchor","polygonUnderMouse","getPolygonUnderMouse","anchorIndex","indexUnderMouse","anchorOnCanvas","endExistingLabelResize","onLabelsDataChange","labelPolygon","pathOnCanvas","linesOnCanvas","mapPointsToLines","j","isMouseOverLine","render","updateCursorStyle","length","anchorUnderMouse","getAnchorUnderMouse","drawActivelyCreatedLabel","standardizedPoints","map","path","lines","line","drawActivelyResizeLabel","activeLabelPolygon","snappedMousePosition","polygonOnCanvas","index","drawExistingLabels","isActive","drawPolygon","drawSuggestedAnchor","suggestedAnchorRect","handleRect","updateActivelyCreatedLabel","mousePositionSnapped","cancelLabelCreation","finishLabelCreation","addLabelAndFinishCreation","isCreationInProgress","polygonOnImage","addPolygonLabel","vertices","labelRects","labelPolygons","startExistingLabelResize","applyResizeToPolygonLabel","activeLabel","discardSuggestedPoint","addSuggestedAnchorToPolygonLabel","newAnchorPositionOnImage","newImageData","arr","newItem","isInProgress","isResizeInProgress","mouse","hoverReach","minX","maxX","minY","maxY","points","start","end","mapPointsToAnchors","PrimaryEditorRenderEngine","drawImage","getContext","imageRect","RectRenderEngine","isMouseOverImage","rectUnderMouse","activeLabelRect","startAnchorPosition","resizeRect","scaledRect","labelRect","addRectLabel","displayAsActive","drawCurrentlyCreatedRect","activeRect","startCreateRectPoint","activeRectBetweenPixels","drawInactiveRect","rectOnImage","drawActiveRect","calculateRectRelativeToActiveImage","startResizeRectAnchor","endAnchorPositionSnapped","renderRect","rectBetweenPixels","lineColor","rectAnchor","handleCenters","handleRectBetweenPixels","getRectUnderMouse","activeRectLabel","isMouseOverRectEdges","outerRectDelta","outerRect","innerRectDelta","innerRect","getAnchorUnderMouseByRect","rectAnchors","anchorRect","startRectCreation","startRectResize","endRectTransformation","CanvasUtil","canvasRect","mousePositionOnViewPortContent","defaultRenderImageRect","viewPortContentImageRect","realImageSize","absoluteViewPortContentScrollPosition","mousePositionOverViewPortContent","viewPortContentScrollPosition","mousePositionOverViewPort","imageSize","mousePositionOverImage","text","FileUtil","Promise","url","URL","onSuccess","resolve","onFailure","reject","reader","evt","contents","useCanvasListeners","annotationType","useEffect","editorData","updateModelAndRender","saveLoadedImage","DEFAULT_SCROLL_POSITION","selector","onContextMenu","CanvasAnnotation","imageFile","onChange","isImageDrag","useMemo","loadStatus","dispatch","useDispatch","updateLabels","isMounted","useRef","currentRelativeScrollPosition","nextRelativeScrollPosition","useCanvasZoom","useSelector","ref","draggable","renderTrackHorizontal","React","renderTrackVertical","isGrabbing","GRABBING","isTransform","DEFAULT","Editor","Canvas","MouseIndicator","Cursor","NoCursorTrack","ReactCanvasAnnotation","LABEL_TYPE","TABS","RECTANGLE","POLYGON","div","TypePicker","useState","tabEnabled","setTabEnabled","useCallback","tab","key","main","TopActions","App","setLabels","setAnnotationType","setImageFile","useReducer","toggleDragMode","setZoom","zoomAction","default","maxZoom","isZoomIn","prev","a","fetch","res","arrayBuffer","buffer","file","File","fetchImage","console","log","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.f0780f21.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/img.c13c8705.jpg\";","import { createGlobalStyle } from 'styled-components';\nimport tw from 'twin.macro';\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    background: linear-gradient(to bottom, #323232 0%, #3F3F3F 40%, #1C1C1C 150%), linear-gradient(to top, rgba(255,255,255,0.40) 0%, rgba(0,0,0,0.25) 200%);\n    background-blend-mode: multiply;\n  }\n  main {\n    ${tw`h-screen w-screen text-white`}\n  }\n  h1 {\n    ${tw`text-2xl text-center`}\n  }\n`;\n\nexport default GlobalStyle;\n","import React from 'react'\nimport styled from 'styled-components'\nimport { ifProp } from 'styled-tools'\nimport tw from 'twin.macro'\n\nconst NOOP = () => {}\n\nconst OptionBox = ({\n  className,\n  children,\n  onClick = NOOP,\n  isPressed = false,\n  disabled = false\n}) => (\n  <Container\n    className={className}\n    onClick={onClick}\n    isPressed={isPressed}\n    disabled={disabled}\n  >\n    {children}\n  </Container>\n)\n\nconst Container = styled.button`\n  ${tw`transition-colors ease-in-out duration-500`}\n  ${tw`cursor-pointer border-gray-500 border p-2 hocus:bg-pink-800`}\n  ${tw`shadow rounded-sm`}\n  ${ifProp(`isPressed`, tw`bg-pink-900`)}\n  ${ifProp(`disabled`, tw`cursor-not-allowed opacity-25`)}\n`\n\nOptionBox.className = Container\n\nexport default OptionBox\n","export enum CursorType {\n  DEFAULT = 'DEFAULT',\n  MOVE = 'MOVE',\n  RESIZE = 'RESIZE',\n  ADD = 'ADD',\n  CANCEL = 'CANCEL',\n  CLOSE = 'CLOSE',\n  GRAB = 'GRAB',\n  GRABBING = 'GRABBING',\n}\n","export enum LabelType {\n  RECTANGLE = 'RECTANGLE',\n  POLYGON = 'POLYGON',\n}\n","export enum PopupWindowType {\n  LOAD_LABEL_NAMES = 'LOAD_LABEL_NAMES',\n  SUGGEST_LABEL_NAMES = 'SUGGEST_LABEL_NAMES',\n  LOAD_IMAGES = 'LOAD_IMAGES',\n  LOAD_AI_MODEL = 'LOAD_AI_MODEL',\n  EXPORT_LABELS = 'EXPORT_LABELS',\n  INSERT_LABEL_NAMES = 'INSERT_LABEL_NAMES',\n  EXIT_PROJECT = 'EXIT_PROJECT',\n  LOADER = 'LOADER',\n}\n","export enum EventType {\n    RESIZE = \"resize\",\n    MOUSE_UP = \"mouseup\",\n    MOUSE_DOWN = \"mousedown\",\n    MOUSE_MOVE = \"mousemove\",\n    MOUSE_WHEEL = \"wheel\",\n    KEY_DOWN = \"keydown\",\n    KEY_PRESS = \"keypress\",\n    KEY_UP = \"keyup\",\n    FOCUS = \"focus\"\n}","export enum Action {\n  // GENERAL\n  UPDATE_WINDOW_SIZE = '@@UPDATE_WINDOW_SIZE',\n  UPDATE_CUSTOM_CURSOR_STYLE = '@@UPDATE_CUSTOM_CURSOR_STYLE',\n  UPDATE_PREVENT_CUSTOM_CURSOR_STATUS = '@@UPDATE_PREVENT_CUSTOM_CURSOR_STATUS',\n  UPDATE_IMAGE_DRAG_MODE_STATUS = '@@UPDATE_IMAGE_DRAG_MODE_STATUS',\n  UPDATE_ZOOM = '@@UPDATE_ZOOM',\n\n  // LABELS\n  UPDATE_FILE_DATA = '@@UPDATE_FILE_DATA',\n  UPDATE_ACTIVE_LABEL_NAME_ID = '@@UPDATE_ACTIVE_LABEL_NAME_ID',\n  UPDATE_ACTIVE_LABEL_TYPE = '@@UPDATE_ACTIVE_LABEL_TYPE',\n  UPDATE_ACTIVE_LABEL_ID = '@@UPDATE_ACTIVE_LABEL_ID',\n  UPDATE_HIGHLIGHTED_LABEL_ID = '@@UPDATE_HIGHLIGHTED_LABEL_ID',\n  UPDATE_FIRST_LABEL_CREATED_FLAG = '@@UPDATE_FIRST_LABEL_CREATED_FLAG',\n  UPDATE_LABELS = '@@UPDATE_LABELS_DATA',\n}\n","import { CursorType } from '../../interfaces/enums/CursorType';\nimport { ISize } from '../../interfaces/ISize';\nimport { Action } from '../Actions';\nimport { GeneralActionTypes } from './types';\n\nexport function updateWindowSize(windowSize: ISize): GeneralActionTypes {\n  return {\n    type: Action.UPDATE_WINDOW_SIZE,\n    payload: {\n      windowSize,\n    },\n  };\n}\n\nexport function updateCustomCursorStyle(customCursorStyle: CursorType): GeneralActionTypes {\n  return {\n    type: Action.UPDATE_CUSTOM_CURSOR_STYLE,\n    payload: {\n      customCursorStyle,\n    },\n  };\n}\n\nexport function updatePreventCustomCursorStatus(preventCustomCursor: boolean): GeneralActionTypes {\n  return {\n    type: Action.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS,\n    payload: {\n      preventCustomCursor,\n    },\n  };\n}\n\nexport function updateImageDragModeStatus(imageDragMode: boolean): GeneralActionTypes {\n  return {\n    type: Action.UPDATE_IMAGE_DRAG_MODE_STATUS,\n    payload: {\n      imageDragMode,\n    },\n  };\n}\n\nexport function updateZoom(zoom: number): GeneralActionTypes {\n  return {\n    type: Action.UPDATE_ZOOM,\n    payload: {\n      zoom,\n    },\n  };\n}\n","export class ViewPointSettings {\n  public static readonly CANVAS_MIN_MARGIN_PX: number = 20;\n  public static readonly MIN_ZOOM: number = 1;\n  public static readonly MAX_ZOOM: number = 4;\n  public static readonly ZOOM_STEP: number = 0.1;\n  public static readonly TRANSLATION_STEP_PX: number = 20;\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { ViewPointSettings } from 'settings/ViewPointSettings';\nimport { Action } from 'store/Actions';\nimport { GeneralActionTypes, GeneralState } from './types';\n\nconst initialState: GeneralState = {\n  windowSize: null,\n  customCursorStyle: CursorType.DEFAULT,\n  preventCustomCursor: false,\n  imageDragMode: false,\n  zoom: ViewPointSettings.MIN_ZOOM,\n};\n\nexport function generalReducer(state = initialState, action: GeneralActionTypes): GeneralState {\n  switch (action.type) {\n    case Action.UPDATE_WINDOW_SIZE: {\n      return {\n        ...state,\n        windowSize: action.payload.windowSize,\n      };\n    }\n    case Action.UPDATE_CUSTOM_CURSOR_STYLE: {\n      return {\n        ...state,\n        customCursorStyle: action.payload.customCursorStyle,\n      };\n    }\n    case Action.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS: {\n      return {\n        ...state,\n        preventCustomCursor: action.payload.preventCustomCursor,\n      };\n    }\n    case Action.UPDATE_IMAGE_DRAG_MODE_STATUS: {\n      return {\n        ...state,\n        imageDragMode: action.payload.imageDragMode,\n      };\n    }\n    case Action.UPDATE_ZOOM: {\n      return {\n        ...state,\n        zoom: action.payload.zoom,\n      };\n    }\n    default:\n      return state;\n  }\n}\n","import { Action } from '../Actions';\nimport { LabelsActionTypes, LabelsState } from './types';\n\nconst initialState: LabelsState = {\n  activeLabelNameId: null,\n  activeLabelType: null,\n  activeLabelId: null,\n  highlightedLabelId: null,\n  imageData: null,\n};\n\nexport function labelsReducer(state = initialState, action: LabelsActionTypes): LabelsState {\n  switch (action.type) {\n    case Action.UPDATE_ACTIVE_LABEL_NAME_ID: {\n      return {\n        ...state,\n        activeLabelNameId: action.payload.activeLabelNameId,\n      };\n    }\n    case Action.UPDATE_ACTIVE_LABEL_ID: {\n      return {\n        ...state,\n        activeLabelId: action.payload.activeLabelId,\n      };\n    }\n    case Action.UPDATE_HIGHLIGHTED_LABEL_ID: {\n      return {\n        ...state,\n        highlightedLabelId: action.payload.highlightedLabelId,\n      };\n    }\n    case Action.UPDATE_ACTIVE_LABEL_TYPE: {\n      return {\n        ...state,\n        activeLabelType: action.payload.activeLabelType,\n      };\n    }\n    case Action.UPDATE_FILE_DATA: {\n      return {\n        ...state,\n        imageData: {\n          ...state.imageData,\n          fileData: action.payload.imageData.fileData,\n        },\n      };\n    }\n    case Action.UPDATE_LABELS: {\n      return {\n        ...state,\n        imageData: {\n          ...state.imageData,\n          ...action.payload.labels,\n        },\n      };\n    }\n    default:\n      return state;\n  }\n}\n","import { EventType } from 'interfaces/enums/EventType';\nimport { combineReducers, createStore } from 'redux';\nimport { updateWindowSize } from './general/actionCreators';\nimport { generalReducer } from './general/reducer';\nimport { labelsReducer } from './labels/reducer';\n\nconst rootReducer = combineReducers({\n  general: generalReducer,\n  labels: labelsReducer,\n});\n\nfunction configureStore() {\n  return createStore(\n    rootReducer,\n    // @ts-ignore\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n  );\n}\n\nexport const store = configureStore();\n\nexport class AppInitializer {\n  public static init(): void {\n    AppInitializer.handleResize();\n    window.addEventListener(EventType.RESIZE, AppInitializer.handleResize);\n  }\n\n  private static handleResize = () => {\n    store.dispatch(\n      updateWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      }),\n    );\n  };\n}\n\nexport type AppState = ReturnType<typeof rootReducer>;\n","import { CursorType } from 'interfaces/enums/CursorType';\n\ntype SvgPath = string;\n\nconst move: SvgPath = `M10.9873 14.1734L11.047 20.4242L10.1004 19.4938C9.94253 19.3386 9.72945 19.2525 9.50806 19.2544C9.28667 19.2563 9.0751 19.346 8.9199 19.5039C8.7647 19.6618 8.67858 19.8749 8.68049 20.0963C8.68239 20.3177 8.77217 20.5292 8.93006 20.6844L11.3114 23.0252C11.3901 23.1007 11.4829 23.1601 11.5845 23.1999C11.7893 23.2825 12.0185 23.2805 12.2219 23.1944C12.3228 23.1528 12.4145 23.0919 12.4919 23.015L14.8326 20.6337C14.9878 20.4758 15.074 20.2627 15.0721 20.0413C15.0702 19.8199 14.9804 19.6083 14.8225 19.4531C14.6646 19.2979 14.4515 19.2118 14.2301 19.2137C14.0087 19.2156 13.7972 19.3054 13.642 19.4633L12.7115 20.4099L12.6637 14.159C12.6617 13.9367 12.5716 13.7243 12.4131 13.5684C12.2545 13.4126 12.0406 13.3261 11.8183 13.328C11.596 13.33 11.3835 13.4201 11.2277 13.5786C11.0719 13.7372 10.9854 13.9511 10.9873 14.1734V14.1734ZM3.18614 11.047L4.11657 10.1004C4.27177 9.94253 4.35789 9.72945 4.35599 9.50806C4.35408 9.28667 4.26431 9.07511 4.10642 8.91991C3.94852 8.76471 3.73544 8.67859 3.51405 8.68049C3.29266 8.6824 3.0811 8.77217 2.9259 8.93007L0.58518 11.3114C0.509651 11.3901 0.450284 11.4829 0.410438 11.5845C0.327862 11.7893 0.329834 12.0185 0.415923 12.2219C0.457511 12.3228 0.518465 12.4145 0.595337 12.4919L2.97669 14.8327C3.13458 14.9879 3.34766 15.074 3.56905 15.0721C3.79044 15.0702 4.00201 14.9804 4.1572 14.8225C4.3124 14.6646 4.39852 14.4515 4.39662 14.2301C4.39471 14.0087 4.30494 13.7972 4.14705 13.642L3.20046 12.7115L9.45135 12.6637C9.56155 12.6632 9.67056 12.6409 9.77209 12.598C9.87363 12.5552 9.96568 12.4927 10.0429 12.4141C10.1202 12.3355 10.1811 12.2424 10.2222 12.1401C10.2633 12.0379 10.2837 11.9285 10.2823 11.8183C10.2818 11.7081 10.2595 11.5991 10.2167 11.4975C10.1738 11.396 10.1113 11.304 10.0327 11.2267C9.95412 11.1495 9.86101 11.0885 9.75875 11.0474C9.6565 11.0064 9.54712 10.9859 9.43693 10.9873L3.18614 11.047ZM19.4531 8.78786C19.2979 8.94575 19.2118 9.15883 19.2137 9.38022C19.2156 9.60161 19.3054 9.81318 19.4633 9.96837L20.4099 10.8988L14.159 10.9467C13.9367 10.9486 13.7243 11.0387 13.5684 11.1973C13.4126 11.3558 13.3261 11.5698 13.328 11.7921C13.33 12.0144 13.4201 12.2268 13.5786 12.3826C13.7372 12.5385 13.9511 12.6249 14.1734 12.623L20.4242 12.5633L19.4938 13.5099C19.3386 13.6678 19.2524 13.8809 19.2544 14.1023C19.2563 14.3237 19.346 14.5352 19.5039 14.6904C19.6618 14.8456 19.8749 14.9318 20.0963 14.9299C20.3177 14.928 20.5292 14.8382 20.6844 14.6803L23.0252 12.2989C23.1007 12.2202 23.1601 12.1275 23.1999 12.0259C23.2825 11.821 23.2805 11.5918 23.1944 11.3884C23.1528 11.2876 23.0919 11.1958 23.015 11.1184L20.6337 8.7777C20.4758 8.6225 20.2627 8.53638 20.0413 8.53828C19.8199 8.54019 19.6083 8.62996 19.4531 8.78786ZM12.0259 0.410442C11.821 0.327866 11.5918 0.329839 11.3884 0.415928C11.2876 0.457516 11.1958 0.518469 11.1184 0.595342L8.7777 2.97669C8.6225 3.13458 8.53638 3.34766 8.53828 3.56905C8.54019 3.79044 8.62996 4.00201 8.78785 4.15721C8.94575 4.31241 9.15883 4.39853 9.38022 4.39662C9.60161 4.39472 9.81317 4.30494 9.96837 4.14705L10.8988 3.20046L10.9467 9.45135C10.9472 9.56155 10.9695 9.67056 11.0123 9.7721C11.0552 9.87363 11.1177 9.96568 11.1963 10.0429C11.2749 10.1202 11.368 10.1811 11.4702 10.2222C11.5725 10.2633 11.6819 10.2837 11.7921 10.2823C11.9023 10.2818 12.0113 10.2595 12.1128 10.2167C12.2143 10.1738 12.3064 10.1113 12.3836 10.0327C12.4609 9.95412 12.5218 9.86101 12.5629 9.75876C12.604 9.6565 12.6244 9.54712 12.623 9.43693L12.5633 3.18614L13.5099 4.11658C13.6678 4.27178 13.8809 4.3579 14.1023 4.35599C14.3237 4.35409 14.5352 4.26431 14.6904 4.10642C14.8456 3.94853 14.9318 3.73545 14.9299 3.51406C14.9279 3.29267 14.8382 3.0811 14.6803 2.9259L12.2989 0.585184C12.2202 0.509655 12.1274 0.450288 12.0259 0.410442V0.410442Z`;\nconst cancel: SvgPath = `M13.41 12L17.71 7.71C17.8983 7.5217 18.0041 7.2663 18.0041 7C18.0041 6.7337 17.8983 6.47831 17.71 6.29C17.5217 6.1017 17.2663 5.99591 17 5.99591C16.7337 5.99591 16.4783 6.1017 16.29 6.29L12 10.59L7.71 6.29C7.5217 6.1017 7.2663 5.99591 7 5.99591C6.7337 5.99591 6.4783 6.1017 6.29 6.29C6.1017 6.47831 5.99591 6.7337 5.99591 7C5.99591 7.2663 6.1017 7.5217 6.29 7.71L10.59 12L6.29 16.29C6.19627 16.383 6.12188 16.4936 6.07111 16.6154C6.02034 16.7373 5.9942 16.868 5.9942 17C5.9942 17.132 6.02034 17.2627 6.07111 17.3846C6.12188 17.5064 6.19627 17.617 6.29 17.71C6.38296 17.8037 6.49356 17.8781 6.61542 17.9289C6.73728 17.9797 6.86799 18.0058 7 18.0058C7.13201 18.0058 7.26272 17.9797 7.38458 17.9289C7.50644 17.8781 7.61704 17.8037 7.71 17.71L12 13.41L16.29 17.71C16.383 17.8037 16.4936 17.8781 16.6154 17.9289C16.7373 17.9797 16.868 18.0058 17 18.0058C17.132 18.0058 17.2627 17.9797 17.3846 17.9289C17.5064 17.8781 17.617 17.8037 17.71 17.71C17.8037 17.617 17.8781 17.5064 17.9289 17.3846C17.9797 17.2627 18.0058 17.132 18.0058 17C18.0058 16.868 17.9797 16.7373 17.9289 16.6154C17.8781 16.4936 17.8037 16.383 17.71 16.29L13.41 12Z`;\nconst crosshair: SvgPath = `M21 11H19.93C19.7068 9.23998 18.9049 7.60408 17.6504 6.34959C16.3959 5.0951 14.76 4.29319 13 4.07V3C13 2.73478 12.8946 2.48043 12.7071 2.29289C12.5196 2.10536 12.2652 2 12 2C11.7348 2 11.4804 2.10536 11.2929 2.29289C11.1054 2.48043 11 2.73478 11 3V4.07C9.23998 4.29319 7.60408 5.0951 6.34959 6.34959C5.0951 7.60408 4.29319 9.23998 4.07 11H3C2.73478 11 2.48043 11.1054 2.29289 11.2929C2.10536 11.4804 2 11.7348 2 12C2 12.2652 2.10536 12.5196 2.29289 12.7071C2.48043 12.8946 2.73478 13 3 13H4.07C4.29319 14.76 5.0951 16.3959 6.34959 17.6504C7.60408 18.9049 9.23998 19.7068 11 19.93V21C11 21.2652 11.1054 21.5196 11.2929 21.7071C11.4804 21.8946 11.7348 22 12 22C12.2652 22 12.5196 21.8946 12.7071 21.7071C12.8946 21.5196 13 21.2652 13 21V19.93C14.76 19.7068 16.3959 18.9049 17.6504 17.6504C18.9049 16.3959 19.7068 14.76 19.93 13H21C21.2652 13 21.5196 12.8946 21.7071 12.7071C21.8946 12.5196 22 12.2652 22 12C22 11.7348 21.8946 11.4804 21.7071 11.2929C21.5196 11.1054 21.2652 11 21 11ZM17 13H17.91C17.7016 14.2264 17.1171 15.3578 16.2374 16.2374C15.3578 17.1171 14.2264 17.7016 13 17.91V17C13 16.7348 12.8946 16.4804 12.7071 16.2929C12.5196 16.1054 12.2652 16 12 16C11.7348 16 11.4804 16.1054 11.2929 16.2929C11.1054 16.4804 11 16.7348 11 17V17.91C9.77356 17.7016 8.64222 17.1171 7.76256 16.2374C6.8829 15.3578 6.29842 14.2264 6.09 13H7C7.26522 13 7.51957 12.8946 7.70711 12.7071C7.89464 12.5196 8 12.2652 8 12C8 11.7348 7.89464 11.4804 7.70711 11.2929C7.51957 11.1054 7.26522 11 7 11H6.09C6.29842 9.77356 6.8829 8.64222 7.76256 7.76256C8.64222 6.8829 9.77356 6.29842 11 6.09V7C11 7.26522 11.1054 7.51957 11.2929 7.70711C11.4804 7.89464 11.7348 8 12 8C12.2652 8 12.5196 7.89464 12.7071 7.70711C12.8946 7.51957 13 7.26522 13 7V6.09C14.2264 6.29842 15.3578 6.8829 16.2374 7.76256C17.1171 8.64222 17.7016 9.77356 17.91 11H17C16.7348 11 16.4804 11.1054 16.2929 11.2929C16.1054 11.4804 16 11.7348 16 12C16 12.2652 16.1054 12.5196 16.2929 12.7071C16.4804 12.8946 16.7348 13 17 13ZM12 11C11.8022 11 11.6089 11.0586 11.4444 11.1685C11.28 11.2784 11.1518 11.4346 11.0761 11.6173C11.0004 11.8 10.9806 12.0011 11.0192 12.1951C11.0578 12.3891 11.153 12.5673 11.2929 12.7071C11.4327 12.847 11.6109 12.9422 11.8049 12.9808C11.9989 13.0194 12.2 12.9996 12.3827 12.9239C12.5654 12.8482 12.7216 12.72 12.8315 12.5556C12.9414 12.3911 13 12.1978 13 12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11Z`;\n\nconst IconPaths: { [key in CursorType & undefined]: SvgPath } = {\n  [CursorType.MOVE]: move,\n  [CursorType.CANCEL]: cancel,\n  [CursorType.GRAB]: crosshair,\n  [CursorType.GRABBING]: crosshair,\n};\n\nexport { IconPaths };\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst SVG = styled.svg``;\n\ntype IProps = {\n  d: string;\n};\n\nconst Icon: React.FC<IProps> = ({ d, ...props }) => (\n  <SVG viewBox=\"0 0 24 24\" {...props}>\n    <path d={d} />\n  </SVG>\n);\n\nexport default Icon;\n","import Scrollbars from 'react-custom-scrollbars';\nimport { IPoint } from '../interfaces/IPoint';\nimport { IRect } from '../interfaces/IRect';\nimport { ISize } from '../interfaces/ISize';\nimport { ViewPortHelper } from '../logic/helpers/ViewPortHelper';\nimport { BaseRenderEngine } from '../logic/render/BaseRenderEngine';\nimport { PrimaryEditorRenderEngine } from '../logic/render/PrimaryEditorRenderEngine';\n\nexport class EditorModel {\n  public static editor: HTMLDivElement;\n  public static canvas: HTMLCanvasElement;\n  public static mousePositionIndicator: HTMLDivElement;\n  public static cursor: HTMLDivElement;\n  public static viewPortScrollbars: Scrollbars;\n  public static image: HTMLImageElement;\n\n  public static primaryRenderingEngine: PrimaryEditorRenderEngine;\n  public static supportRenderingEngine: BaseRenderEngine;\n\n  public static viewPortHelper: ViewPortHelper;\n\n  public static isLoading: boolean = false;\n  public static viewPortActionsDisabled: boolean = false;\n  public static mousePositionOnViewPortContent: IPoint;\n  public static viewPortSize: ISize;\n\n  // x and y describe the dimension of the margin that remains constant regardless of the scale of the image\n  // width and height describes the render image size for 100% scale\n  public static defaultRenderImageRect: IRect;\n}\n","export enum Direction {\n    TOP = \"TOP\",\n    BOTTOM = \"BOTTOM\",\n    LEFT = \"LEFT\",\n    RIGHT = \"RIGHT\",\n    TOP_RIGHT = \"TOP_RIGHT\",\n    TOP_LEFT = \"TOP_LEFT\",\n    BOTTOM_RIGHT = \"BOTTOM_RIGHT\",\n    BOTTOM_LEFT = \"BOTTOM_LEFT\",\n    CENTER = \"CENTER\"\n}","import { CursorType } from 'interfaces/enums';\nimport { store } from 'store';\n\nexport class GeneralSelector {\n  public static getPreventCustomCursorStatus(): boolean {\n    return store.getState().general.preventCustomCursor;\n  }\n\n  public static getImageDragModeStatus(): boolean {\n    return store.getState().general.imageDragMode;\n  }\n\n  public static getCustomCursorStyle(): CursorType {\n    return store.getState().general.customCursorStyle;\n  }\n\n  public static getZoom(): number {\n    return store.getState().general.zoom;\n  }\n}\n","import { Direction } from '../interfaces/enums/Direction';\nimport { IPoint } from '../interfaces/IPoint';\n\nexport class DirectionUtil {\n  public static convertDirectionToVector(direction: Direction): IPoint {\n    switch (direction) {\n      case Direction.RIGHT:\n        return { x: 1, y: 0 };\n      case Direction.LEFT:\n        return { x: -1, y: 0 };\n      case Direction.TOP:\n        return { x: 0, y: 1 };\n      case Direction.BOTTOM:\n        return { x: 0, y: -1 };\n      case Direction.TOP_RIGHT:\n        return { x: 1, y: 1 };\n      case Direction.TOP_LEFT:\n        return { x: -1, y: 1 };\n      case Direction.BOTTOM_RIGHT:\n        return { x: 1, y: -1 };\n      case Direction.BOTTOM_LEFT:\n        return { x: -1, y: -1 };\n      case Direction.CENTER:\n        return { x: 0, y: 0 };\n      default:\n        return null;\n    }\n  }\n}\n","import { ISize } from '../interfaces/ISize';\n\nexport class ImageUtil {\n  public static getSize(image: HTMLImageElement): ISize {\n    if (!image) return null;\n    return {\n      width: image.width,\n      height: image.height,\n    };\n  }\n}\n","export class NumberUtil {\n  public static snapValueToRange(\n    value: number,\n    min: number,\n    max: number\n  ): number {\n    if (value < min) return min;\n    if (value > max) return max;\n\n    return value;\n  }\n\n  public static isValueInRange(\n    value: number,\n    min: number,\n    max: number\n  ): boolean {\n    return value >= min && value <= max;\n  }\n}\n","import { IPoint } from '../interfaces/IPoint';\n\nexport class PointUtil {\n  public static equals(p1: IPoint, p2: IPoint): boolean {\n    return p1.x === p2.x && p1.y === p2.y;\n  }\n\n  public static add(p1: IPoint, p2: IPoint): IPoint {\n    return {\n      x: p1.x + p2.x,\n      y: p1.y + p2.y,\n    };\n  }\n\n  public static subtract(p1: IPoint, p2: IPoint): IPoint {\n    return {\n      x: p1.x - p2.x,\n      y: p1.y - p2.y,\n    };\n  }\n\n  public static multiply(p1: IPoint, factor: number) {\n    return {\n      x: p1.x * factor,\n      y: p1.y * factor,\n    };\n  }\n\n  public static getEuclidianDistance(p1: IPoint, p2: IPoint): number {\n    return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n  }\n}\n","import { Direction } from 'interfaces/enums/Direction';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { RectAnchor } from 'interfaces/IRectAnchor';\nimport { ISize } from 'interfaces/ISize';\nimport { NumberUtil } from './NumberUtil';\n\nexport class RectUtil {\n  public static getRatio(rect: IRect): number {\n    if (!rect) return null;\n\n    return rect.width / rect.height;\n  }\n\n  public static intersect(r1: IRect, r2: IRect) {\n    if (!r1 || !r2) return null;\n    return !(\n      r2.x > r1.x + r1.width ||\n      r2.x + r2.width < r1.x ||\n      r2.y > r1.y + r1.height ||\n      r2.y + r2.height < r1.y\n    );\n  }\n\n  public static isPointInside(rect: IRect, point: IPoint): boolean {\n    if (!rect || !point) return null;\n    return (\n      rect.x < point.x &&\n      rect.x + rect.width > point.x &&\n      rect.y < point.y &&\n      rect.y + rect.height > point.y\n    );\n  }\n\n  public static getRectWithCenterAndSize(centerPoint: IPoint, size: ISize): IRect {\n    return {\n      x: centerPoint.x - 0.5 * size.width,\n      y: centerPoint.y - 0.5 * size.height,\n      ...size,\n    };\n  }\n\n  public static fitInsideRectWithRatio(containerRect: IRect, ratio: number): IRect {\n    const containerRectRatio = RectUtil.getRatio(containerRect);\n    if (containerRectRatio < ratio) {\n      const innerRectHeight = containerRect.width / ratio;\n      return {\n        x: containerRect.x,\n        y: containerRect.y + (containerRect.height - innerRectHeight) / 2,\n        width: containerRect.width,\n        height: innerRectHeight,\n      };\n    } else {\n      const innerRectWidth = containerRect.height * ratio;\n      return {\n        x: containerRect.x + (containerRect.width - innerRectWidth) / 2,\n        y: containerRect.y,\n        width: innerRectWidth,\n        height: containerRect.height,\n      };\n    }\n  }\n\n  public static resizeRect(inputRect: IRect, rectAnchor: Direction, delta): IRect {\n    const rect: IRect = { ...inputRect };\n    switch (rectAnchor) {\n      case Direction.RIGHT:\n        rect.width += delta.x;\n        break;\n      case Direction.BOTTOM_RIGHT:\n        rect.width += delta.x;\n        rect.height += delta.y;\n        break;\n      case Direction.BOTTOM:\n        rect.height += delta.y;\n        break;\n      case Direction.TOP_RIGHT:\n        rect.width += delta.x;\n        rect.y += delta.y;\n        rect.height -= delta.y;\n        break;\n      case Direction.TOP:\n        rect.y += delta.y;\n        rect.height -= delta.y;\n        break;\n      case Direction.TOP_LEFT:\n        rect.x += delta.x;\n        rect.width -= delta.x;\n        rect.y += delta.y;\n        rect.height -= delta.y;\n        break;\n      case Direction.LEFT:\n        rect.x += delta.x;\n        rect.width -= delta.x;\n        break;\n      case Direction.BOTTOM_LEFT:\n        rect.x += delta.x;\n        rect.width -= delta.x;\n        rect.height += delta.y;\n        break;\n    }\n\n    if (rect.width < 0) {\n      rect.x = rect.x + rect.width;\n      rect.width = -rect.width;\n    }\n\n    if (rect.height < 0) {\n      rect.y = rect.y + rect.height;\n      rect.height = -rect.height;\n    }\n\n    return rect;\n  }\n\n  public static translate(rect: IRect, delta: IPoint): IRect {\n    return {\n      ...rect,\n      x: rect.x + delta.x,\n      y: rect.y + delta.y,\n    };\n  }\n\n  public static expand(rect: IRect, delta: IPoint): IRect {\n    return {\n      x: rect.x - delta.x,\n      y: rect.y - delta.y,\n      width: rect.width + 2 * delta.x,\n      height: rect.height + 2 * delta.y,\n    };\n  }\n\n  public static scaleRect(rect: IRect, scale: number): IRect {\n    return {\n      x: rect.x * scale,\n      y: rect.y * scale,\n      width: rect.width * scale,\n      height: rect.height * scale,\n    };\n  }\n\n  public static mapRectToAnchors(rect: IRect): RectAnchor[] {\n    return [\n      { type: Direction.TOP_LEFT, position: { x: rect.x, y: rect.y } },\n      { type: Direction.TOP, position: { x: rect.x + 0.5 * rect.width, y: rect.y } },\n      { type: Direction.TOP_RIGHT, position: { x: rect.x + rect.width, y: rect.y } },\n      { type: Direction.LEFT, position: { x: rect.x, y: rect.y + 0.5 * rect.height } },\n      {\n        type: Direction.RIGHT,\n        position: { x: rect.x + rect.width, y: rect.y + 0.5 * rect.height },\n      },\n      { type: Direction.BOTTOM_LEFT, position: { x: rect.x, y: rect.y + rect.height } },\n      {\n        type: Direction.BOTTOM,\n        position: { x: rect.x + 0.5 * rect.width, y: rect.y + rect.height },\n      },\n      {\n        type: Direction.BOTTOM_RIGHT,\n        position: { x: rect.x + rect.width, y: rect.y + rect.height },\n      },\n    ];\n  }\n\n  public static snapPointToRect(point: IPoint, rect: IRect): IPoint {\n    if (RectUtil.isPointInside(rect, point)) return point;\n\n    return {\n      x: NumberUtil.snapValueToRange(point.x, rect.x, rect.x + rect.width),\n      y: NumberUtil.snapValueToRange(point.y, rect.y, rect.y + rect.height),\n    };\n  }\n}\n","import { ISize } from '../interfaces/ISize';\n\nexport class SizeUtil {\n  public static scale(size: ISize, scale: number): ISize {\n    return {\n      width: size.width * scale,\n      height: size.height * scale,\n    };\n  }\n}\n","import { Direction } from 'interfaces/enums/Direction';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { ISize } from 'interfaces/ISize';\nimport { EditorModel } from 'model/EditorModel';\nimport { ViewPointSettings } from 'settings/ViewPointSettings';\nimport { store } from 'store';\nimport { updateZoom } from 'store/general/actionCreators';\nimport { GeneralSelector } from 'store/selectors/GeneralSelector';\nimport { DirectionUtil } from 'utils/DirectionUtil';\nimport { ImageUtil } from 'utils/ImageUtil';\nimport { NumberUtil } from 'utils/NumberUtil';\nimport { PointUtil } from 'utils/PointUtil';\nimport { RectUtil } from 'utils/RectUtil';\nimport { SizeUtil } from 'utils/SizeUtil';\nimport { EditorActions } from './EditorActions';\n\nexport class ViewPortActions {\n  public static updateViewPortSize() {\n    if (!!EditorModel.editor) {\n      EditorModel.viewPortSize = {\n        width: EditorModel.editor.offsetWidth,\n        height: EditorModel.editor.offsetHeight,\n      };\n    }\n  }\n\n  public static updateDefaultViewPortImageRect() {\n    if (!!EditorModel.viewPortSize && !!EditorModel.image) {\n      const minMargin: IPoint = {\n        x: ViewPointSettings.CANVAS_MIN_MARGIN_PX,\n        y: ViewPointSettings.CANVAS_MIN_MARGIN_PX,\n      };\n      const realImageRect: IRect = { x: 0, y: 0, ...ImageUtil.getSize(EditorModel.image) };\n      const viewPortWithMarginRect: IRect = { x: 0, y: 0, ...EditorModel.viewPortSize };\n      const viewPortWithoutMarginRect: IRect = RectUtil.expand(\n        viewPortWithMarginRect,\n        PointUtil.multiply(minMargin, -1),\n      );\n      EditorModel.defaultRenderImageRect = RectUtil.fitInsideRectWithRatio(\n        viewPortWithoutMarginRect,\n        RectUtil.getRatio(realImageRect),\n      );\n    }\n  }\n\n  public static calculateViewPortContentSize(): ISize {\n    if (!!EditorModel.viewPortSize && !!EditorModel.image) {\n      const defaultViewPortImageRect: IRect = EditorModel.defaultRenderImageRect;\n      const scaledImageSize: ISize = SizeUtil.scale(\n        EditorModel.defaultRenderImageRect,\n        GeneralSelector.getZoom(),\n      );\n      return {\n        width: scaledImageSize.width + 2 * defaultViewPortImageRect.x,\n        height: scaledImageSize.height + 2 * defaultViewPortImageRect.y,\n      };\n    } else {\n      return null;\n    }\n  }\n\n  public static calculateViewPortContentImageRect(): IRect {\n    if (!!EditorModel.viewPortSize && !!EditorModel.image) {\n      const defaultViewPortImageRect: IRect = EditorModel.defaultRenderImageRect;\n      const viewPortContentSize: ISize = ViewPortActions.calculateViewPortContentSize();\n      return {\n        ...defaultViewPortImageRect,\n        width: viewPortContentSize.width - 2 * defaultViewPortImageRect.x,\n        height: viewPortContentSize.height - 2 * defaultViewPortImageRect.y,\n      };\n    } else {\n      return null;\n    }\n  }\n\n  public static resizeCanvas(newCanvasSize: ISize) {\n    if (!!newCanvasSize && !!EditorModel.canvas) {\n      EditorModel.canvas.width = newCanvasSize.width;\n      EditorModel.canvas.height = newCanvasSize.height;\n    }\n  }\n\n  public static resizeViewPortContent() {\n    const viewPortContentSize = ViewPortActions.calculateViewPortContentSize();\n    viewPortContentSize && ViewPortActions.resizeCanvas(viewPortContentSize);\n  }\n\n  public static calculateAbsoluteScrollPosition(relativePosition: IPoint): IPoint {\n    const viewPortContentSize = ViewPortActions.calculateViewPortContentSize();\n    const viewPortSize = EditorModel.viewPortSize;\n    return {\n      x: relativePosition.x * (viewPortContentSize.width - viewPortSize.width),\n      y: relativePosition.y * (viewPortContentSize.height - viewPortSize.height),\n    };\n  }\n\n  public static getRelativeScrollPosition(): IPoint {\n    if (!!EditorModel.viewPortScrollbars) {\n      const values = EditorModel.viewPortScrollbars.getValues();\n      return {\n        x: values.left,\n        y: values.top,\n      };\n    } else {\n      return null;\n    }\n  }\n\n  public static getAbsoluteScrollPosition(): IPoint {\n    if (!!EditorModel.viewPortScrollbars) {\n      const values = EditorModel.viewPortScrollbars.getValues();\n      return {\n        x: values.scrollLeft,\n        y: values.scrollTop,\n      };\n    } else {\n      return null;\n    }\n  }\n\n  public static setScrollPosition(position: IPoint) {\n    EditorModel.viewPortScrollbars.scrollLeft(position.x);\n    EditorModel.viewPortScrollbars.scrollTop(position.y);\n  }\n\n  public static translateViewPortPosition(direction: Direction) {\n    if (EditorModel.viewPortActionsDisabled) return;\n\n    const directionVector: IPoint = DirectionUtil.convertDirectionToVector(direction);\n    const translationVector: IPoint = PointUtil.multiply(\n      directionVector,\n      ViewPointSettings.TRANSLATION_STEP_PX,\n    );\n    const currentScrollPosition = ViewPortActions.getAbsoluteScrollPosition();\n    const nextScrollPosition = PointUtil.add(currentScrollPosition, translationVector);\n    ViewPortActions.setScrollPosition(nextScrollPosition);\n    EditorActions.fullRender();\n  }\n\n  public static setZoom(value: number) {\n    const currentZoom: number = GeneralSelector.getZoom();\n    const isNewValueValid: boolean = NumberUtil.isValueInRange(\n      value,\n      ViewPointSettings.MIN_ZOOM,\n      ViewPointSettings.MAX_ZOOM,\n    );\n\n    if (isNewValueValid && value !== currentZoom) {\n      store.dispatch(updateZoom(value));\n    }\n  }\n}\n","import { EventType } from '../interfaces/enums/EventType';\n\nexport class MouseEventUtil {\n  public static getEventType(event: Event): EventType | null {\n    if (!event) return null;\n\n    switch (event.type) {\n      case EventType.MOUSE_DOWN:\n        return EventType.MOUSE_DOWN;\n      case EventType.MOUSE_UP:\n        return EventType.MOUSE_UP;\n      case EventType.MOUSE_MOVE:\n        return EventType.MOUSE_MOVE;\n      default:\n        return null;\n    }\n  }\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { EventType } from 'interfaces/enums/EventType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { IPoint } from 'interfaces/IPoint';\nimport { ViewPortActions } from 'logic/actions/ViewPortActions';\nimport { EditorModel } from 'model/EditorModel';\nimport { store } from 'store';\nimport { updateCustomCursorStyle } from 'store/general/actionCreators';\nimport { MouseEventUtil } from 'utils/MouseEventUtil';\nimport { PointUtil } from 'utils/PointUtil';\n\nexport class ViewPortHelper {\n  private startScrollPosition: IPoint;\n  private mouseStartPosition: IPoint;\n\n  public update(data: IEditorData): void {\n    if (!!data.event) {\n      switch (MouseEventUtil.getEventType(data.event)) {\n        case EventType.MOUSE_MOVE:\n          this.mouseMoveHandler(data);\n          break;\n        case EventType.MOUSE_UP:\n          this.mouseUpHandler();\n          break;\n        case EventType.MOUSE_DOWN:\n          this.mouseDownHandler(data);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  private mouseDownHandler(data: IEditorData) {\n    const event = data.event as MouseEvent;\n    this.startScrollPosition = data.absoluteViewPortContentScrollPosition;\n    this.mouseStartPosition = { x: event.screenX, y: event.screenY };\n\n    store.dispatch(updateCustomCursorStyle(CursorType.GRABBING));\n    EditorModel.canvas.style.cursor = 'none';\n  }\n\n  private mouseUpHandler() {\n    this.startScrollPosition = null;\n    this.mouseStartPosition = null;\n    store.dispatch(updateCustomCursorStyle(CursorType.GRAB));\n    EditorModel.canvas.style.cursor = 'none';\n  }\n\n  private mouseMoveHandler(data: IEditorData) {\n    if (!!this.startScrollPosition && !!this.mouseStartPosition) {\n      const event = data.event as MouseEvent;\n      const currentMousePosition: IPoint = { x: event.screenX, y: event.screenY };\n      const mousePositionDelta: IPoint = PointUtil.subtract(\n        currentMousePosition,\n        this.mouseStartPosition,\n      );\n      const nextScrollPosition = PointUtil.subtract(this.startScrollPosition, mousePositionDelta);\n      ViewPortActions.setScrollPosition(nextScrollPosition);\n      store.dispatch(updateCustomCursorStyle(CursorType.GRABBING));\n    } else {\n      store.dispatch(updateCustomCursorStyle(CursorType.GRAB));\n    }\n    EditorModel.canvas.style.cursor = 'none';\n  }\n}\n","import { PopupWindowType } from 'interfaces/enums';\n\nexport class Settings {\n  public static readonly PRIMARY_COLOR: string = '#F8C182';\n  public static readonly SECONDARY_COLOR: string = '#EC77FF';\n\n  public static readonly DARK_THEME_SECOND_COLOR: string = '#282828';\n  public static readonly DARK_THEME_THIRD_COLOR: string = '#4c4c4c';\n  public static readonly DARK_THEME_FORTH_COLOR: string = '#262c2f';\n\n  public static readonly RESIZE_HANDLE_DIMENSION_PX: number = 8;\n  public static readonly RESIZE_HANDLE_HOVER_DIMENSION_PX = 16;\n\n  public static readonly CLOSEABLE_POPUPS: PopupWindowType[] = [\n    PopupWindowType.LOAD_IMAGES,\n    PopupWindowType.EXPORT_LABELS,\n    PopupWindowType.EXIT_PROJECT,\n  ];\n}\n","import { ISize } from 'interfaces';\nimport { Settings } from './Settings';\n\nexport class RenderEngineConfig {\n  public readonly lineThickness: number = 2;\n  public readonly lineActiveColor: string = Settings.PRIMARY_COLOR;\n  public readonly lineInactiveColor: string = '#fff';\n  public readonly anchorSize: ISize = {\n    width: Settings.RESIZE_HANDLE_DIMENSION_PX,\n    height: Settings.RESIZE_HANDLE_DIMENSION_PX,\n  };\n  public readonly anchorHoverSize: ISize = {\n    width: Settings.RESIZE_HANDLE_HOVER_DIMENSION_PX,\n    height: Settings.RESIZE_HANDLE_HOVER_DIMENSION_PX,\n  };\n  public readonly suggestedAnchorDetectionSize: ISize = {\n    width: 100,\n    height: 100,\n  };\n  public readonly activeAnchorColor: string = Settings.SECONDARY_COLOR;\n}\n","import { LabelType } from '../../interfaces/enums/LabelType';\nimport { Action } from '../Actions';\nimport { AnnotationData, LabelsActionTypes, LabelsData } from './types';\n\nexport function updateActiveLabelNameId(activeLabelNameId: string): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_ACTIVE_LABEL_NAME_ID,\n    payload: {\n      activeLabelNameId,\n    },\n  };\n}\n\nexport function updateActiveLabelId(activeLabelId: string): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_ACTIVE_LABEL_ID,\n    payload: {\n      activeLabelId,\n    },\n  };\n}\n\nexport function updateHighlightedLabelId(highlightedLabelId: string): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_HIGHLIGHTED_LABEL_ID,\n    payload: {\n      highlightedLabelId,\n    },\n  };\n}\n\nexport function updateActiveLabelType(activeLabelType: LabelType): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_ACTIVE_LABEL_TYPE,\n    payload: {\n      activeLabelType,\n    },\n  };\n}\n\nexport function updateImageData(imageData: AnnotationData): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_FILE_DATA,\n    payload: {\n      imageData,\n    },\n  };\n}\n\nexport function updateLabels(labels: LabelsData): LabelsActionTypes {\n  return {\n    type: Action.UPDATE_LABELS,\n    payload: {\n      labels,\n    },\n  };\n}\n","import { LabelType } from 'interfaces/enums';\nimport find from 'lodash.find';\nimport { store } from 'store';\nimport { AnnotationData, LabelPolygon, LabelRect } from 'store/labels/types';\n\nexport class LabelsSelector {\n  public static getActiveLabelType(): LabelType {\n    return store.getState().labels.activeLabelType;\n  }\n\n  public static getImageData(): AnnotationData {\n    return store.getState().labels.imageData;\n  }\n\n  public static getImageDataById(): AnnotationData {\n    const imagesData: AnnotationData = LabelsSelector.getImageData();\n    return imagesData[0];\n  }\n\n  public static getActiveLabelId(): string | null {\n    return store.getState().labels.activeLabelId;\n  }\n\n  public static getHighlightedLabelId(): string | null {\n    return store.getState().labels.highlightedLabelId;\n  }\n\n  public static getActiveRectLabel(): LabelRect | null {\n    const activeLabelId: string | null = LabelsSelector.getActiveLabelId();\n\n    if (activeLabelId === null) return null;\n\n    return find(LabelsSelector.getImageData().labelRects, { id: activeLabelId });\n  }\n\n  public static getActivePolygonLabel(): LabelPolygon | null {\n    const activeLabelId: string | null = LabelsSelector.getActiveLabelId();\n\n    if (activeLabelId === null) return null;\n\n    return find(LabelsSelector.getImageData().labelPolygons, { id: activeLabelId });\n  }\n}\n","export class UnitUtil {\n\n    public static deg2rad(angleDeg:number) {\n        return(angleDeg * Math.PI/180);\n    }\n\n    public static rad2deg(angleRad:number) {\n        return(angleRad * 180/Math.PI);\n    }\n}","import { IPoint } from '../interfaces/IPoint';\nimport { IRect } from '../interfaces/IRect';\nimport { UnitUtil } from './UnitUtil';\n\nexport class DrawUtil {\n  public static clearCanvas(canvas: HTMLCanvasElement): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n  }\n\n  public static drawLine(\n    canvas: HTMLCanvasElement,\n    startPoint: IPoint,\n    endPoint: IPoint,\n    color: string = '#111111',\n    thickness: number = 1,\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = thickness;\n    ctx.lineCap = 'round';\n    ctx.beginPath();\n    ctx.moveTo(startPoint.x, startPoint.y);\n    ctx.lineTo(endPoint.x + 1, endPoint.y + 1);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  public static drawRect(\n    canvas: HTMLCanvasElement,\n    rect: IRect,\n    color: string = '#fff',\n    thickness: number = 1,\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = thickness;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  public static drawRectWithFill(\n    canvas: HTMLCanvasElement,\n    rect: IRect,\n    color: string = '#fff',\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.fill();\n    ctx.restore();\n  }\n\n  public static shadeEverythingButRect(\n    canvas: HTMLCanvasElement,\n    rect: IRect,\n    color: string = 'rgba(0, 0, 0, 0.7)',\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.fillStyle = color;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.globalCompositeOperation = 'destination-out';\n    ctx.fillRect(rect.x, rect.y, rect.width, rect.height);\n    ctx.restore();\n  }\n\n  public static drawCircleWithFill(\n    canvas: HTMLCanvasElement,\n    anchorPoint: IPoint,\n    radius: number,\n    color: string = '#ffffff',\n  ): void {\n    const ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    const startAngleRad = UnitUtil.deg2rad(0);\n    const endAngleRad = UnitUtil.deg2rad(360);\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.arc(anchorPoint.x, anchorPoint.y, radius, startAngleRad, endAngleRad, false);\n    ctx.fill();\n    ctx.restore();\n  }\n\n  public static drawCircle(\n    canvas: HTMLCanvasElement,\n    anchorPoint: IPoint,\n    radius: number,\n    startAngleDeg: number,\n    endAngleDeg: number,\n    thickness: number = 20,\n    color: string = '#ffffff',\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    let startAngleRad = UnitUtil.deg2rad(startAngleDeg);\n    let endAngleRad = UnitUtil.deg2rad(endAngleDeg);\n    ctx.save();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = thickness;\n    ctx.beginPath();\n    ctx.arc(anchorPoint.x, anchorPoint.y, radius, startAngleRad, endAngleRad, false);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  public static drawPolygon(\n    canvas: HTMLCanvasElement,\n    anchors: IPoint[],\n    color: string = '#fff',\n    thickness: number = 1,\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = thickness;\n    ctx.beginPath();\n    ctx.moveTo(anchors[0].x, anchors[0].y);\n    for (let i = 1; i < anchors.length; i++) {\n      ctx.lineTo(anchors[i].x, anchors[i].y);\n    }\n    ctx.closePath();\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  public static drawPolygonWithFill(\n    canvas: HTMLCanvasElement,\n    anchors: IPoint[],\n    color: string = '#fff',\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(anchors[0].x, anchors[0].y);\n    for (let i = 1; i < anchors.length; i++) {\n      ctx.lineTo(anchors[i].x, anchors[i].y);\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n  }\n\n  public static drawText(\n    canvas: HTMLCanvasElement,\n    text: string,\n    textSize: number,\n    anchorPoint: IPoint,\n    color: string = '#ffffff',\n    bold: boolean = false,\n    align: string = 'center',\n  ): void {\n    let ctx: CanvasRenderingContext2D = canvas.getContext('2d');\n    ctx.save();\n    ctx.fillStyle = color;\n    ctx.textAlign = align as CanvasTextAlign;\n    ctx.textBaseline = 'middle';\n    ctx.font = (bold ? 'bold ' : '') + textSize + 'px Arial';\n    ctx.fillText(text, anchorPoint.x, anchorPoint.y);\n    ctx.restore();\n  }\n\n  public static getRandomRGBColor(): string {\n    return (\n      'rgb(' +\n      Math.round(Math.random() * 255) +\n      ',' +\n      Math.round(Math.random() * 255) +\n      ',' +\n      Math.round(Math.random() * 255) +\n      ')'\n    );\n  }\n\n  public static hexToRGB(hex: string, alpha: number): string {\n    const r = parseInt(hex.slice(1, 3), 16);\n    const g = parseInt(hex.slice(3, 5), 16);\n    const b = parseInt(hex.slice(5, 7), 16);\n\n    if (alpha) {\n      return 'rgba(' + r + ', ' + g + ', ' + b + ', ' + alpha + ')';\n    } else {\n      return 'rgb(' + r + ', ' + g + ', ' + b + ')';\n    }\n  }\n}\n","import { ILine } from '../interfaces/ILine';\nimport { IPoint } from '../interfaces/IPoint';\n\nexport class LineUtil {\n  public static getDistanceFromLine(l: ILine, p: IPoint): number {\n    if (l.start.x !== l.end.x || l.start.y !== l.end.y) {\n      const nom: number = Math.abs(\n        (l.end.y - l.start.y) * p.x -\n          (l.end.x - l.start.x) * p.y +\n          l.end.x * l.start.y -\n          l.end.y * l.start.x,\n      );\n      const denom: number = Math.sqrt(\n        Math.pow(l.end.y - l.start.y, 2) + Math.pow(l.end.x - l.start.x, 2),\n      );\n      return nom / denom;\n    }\n    return null;\n  }\n\n  public static getCenter(l: ILine): IPoint {\n    return {\n      x: (l.start.x + l.end.x) / 2,\n      y: (l.start.y + l.end.y) / 2,\n    };\n  }\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { store } from 'store';\nimport { updateCustomCursorStyle } from 'store/general/actionCreators';\nimport { PointUtil } from './PointUtil';\nimport { RectUtil } from './RectUtil';\n\nexport class RenderEngineUtil {\n  public static calculateImageScale(data: IEditorData): number {\n    return data.realImageSize.width / data.viewPortContentImageRect.width;\n  }\n\n  public static isMouseOverImage(data: IEditorData): boolean {\n    return RectUtil.isPointInside(\n      data.viewPortContentImageRect,\n      data.mousePositionOnViewPortContent,\n    );\n  }\n\n  public static isMouseOverCanvas(data: IEditorData): boolean {\n    return RectUtil.isPointInside(\n      { x: 0, y: 0, ...data.viewPortContentSize },\n      data.mousePositionOnViewPortContent,\n    );\n  }\n\n  public static transferPolygonFromImageToViewPortContent(\n    polygon: IPoint[],\n    data: IEditorData,\n  ): IPoint[] {\n    return polygon.map((point: IPoint) =>\n      RenderEngineUtil.transferPointFromImageToViewPortContent(point, data),\n    );\n  }\n\n  public static transferPointFromImageToViewPortContent(point: IPoint, data: IEditorData): IPoint {\n    const scale = RenderEngineUtil.calculateImageScale(data);\n    return PointUtil.add(PointUtil.multiply(point, 1 / scale), data.viewPortContentImageRect);\n  }\n\n  public static transferPolygonFromViewPortContentToImage(\n    polygon: IPoint[],\n    data: IEditorData,\n  ): IPoint[] {\n    return polygon.map((point: IPoint) =>\n      RenderEngineUtil.transferPointFromViewPortContentToImage(point, data),\n    );\n  }\n\n  public static transferPointFromViewPortContentToImage(point: IPoint, data: IEditorData): IPoint {\n    const scale = RenderEngineUtil.calculateImageScale(data);\n    return PointUtil.multiply(PointUtil.subtract(point, data.viewPortContentImageRect), scale);\n  }\n\n  public static transferRectFromViewPortContentToImage(rect: IRect, data: IEditorData): IRect {\n    const scale = RenderEngineUtil.calculateImageScale(data);\n    return RectUtil.translate(RectUtil.scaleRect(rect, 1 / scale), data.viewPortContentImageRect);\n  }\n\n  public static transferRectFromImageToViewPortContent(rect: IRect, data: IEditorData): IRect {\n    const scale = RenderEngineUtil.calculateImageScale(data);\n    const translation: IPoint = {\n      x: -data.viewPortContentImageRect.x,\n      y: -data.viewPortContentImageRect.y,\n    };\n\n    return RectUtil.scaleRect(RectUtil.translate(rect, translation), scale);\n  }\n\n  public static wrapDefaultCursorStyleInCancel(data: IEditorData) {\n    if (\n      RectUtil.isPointInside(data.viewPortContentImageRect, data.mousePositionOnViewPortContent)\n    ) {\n      store.dispatch(updateCustomCursorStyle(CursorType.DEFAULT));\n    } else {\n      store.dispatch(updateCustomCursorStyle(CursorType.CANCEL));\n    }\n  }\n\n  public static setValueBetweenPixels(value: number): number {\n    return Math.floor(value) + 0.5;\n  }\n\n  public static setPointBetweenPixels(point: IPoint): IPoint {\n    return {\n      x: RenderEngineUtil.setValueBetweenPixels(point.x),\n      y: RenderEngineUtil.setValueBetweenPixels(point.y),\n    };\n  }\n\n  public static setRectBetweenPixels(rect: IRect): IRect {\n    const topLeft: IPoint = {\n      x: rect.x,\n      y: rect.y,\n    };\n    const bottomRight: IPoint = {\n      x: rect.x + rect.width,\n      y: rect.y + rect.height,\n    };\n    const topLeftBetweenPixels = RenderEngineUtil.setPointBetweenPixels(topLeft);\n    const bottomRightBetweenPixels = RenderEngineUtil.setPointBetweenPixels(bottomRight);\n    return {\n      x: topLeftBetweenPixels.x,\n      y: topLeftBetweenPixels.y,\n      width: bottomRightBetweenPixels.x - topLeftBetweenPixels.x,\n      height: bottomRightBetweenPixels.y - topLeftBetweenPixels.y,\n    };\n  }\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","import { EventType } from 'interfaces/enums/EventType';\nimport { LabelType } from 'interfaces/enums/LabelType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { LabelsData } from 'store/labels/types';\nimport { MouseEventUtil } from 'utils/MouseEventUtil';\n\nexport abstract class BaseRenderEngine {\n  protected readonly canvas: HTMLCanvasElement;\n  public labelType: LabelType;\n\n  protected constructor(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n  }\n\n  public update(data: IEditorData, onLabelsDataChange?: (labelsData: LabelsData) => void): void {\n    if (!!data.event) {\n      switch (MouseEventUtil.getEventType(data.event)) {\n        case EventType.MOUSE_MOVE:\n          this.mouseMoveHandler(data);\n          break;\n        case EventType.MOUSE_UP:\n          this.mouseUpHandler(data, onLabelsDataChange);\n          break;\n        case EventType.MOUSE_DOWN:\n          this.mouseDownHandler(data, onLabelsDataChange);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  protected abstract mouseDownHandler(\n    data: IEditorData,\n    onLabelsDataChange?: (labelsData: LabelsData) => void,\n  ): void;\n  protected abstract mouseMoveHandler(data: IEditorData): void;\n  protected abstract mouseUpHandler(\n    data: IEditorData,\n    onLabelsDataChange?: (labelsData: LabelsData) => void,\n  ): void;\n\n  abstract render(data: IEditorData): void;\n\n  abstract isInProgress(): boolean;\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { EventType } from 'interfaces/enums/EventType';\nimport { LabelType } from 'interfaces/enums/LabelType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { ILine } from 'interfaces/ILine';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { EditorActions } from 'logic/actions/EditorActions';\nimport { RenderEngineConfig } from 'settings/RenderEngineConfig';\nimport { store } from 'store';\nimport { updateCustomCursorStyle } from 'store/general/actionCreators';\nimport {\n  updateActiveLabelId,\n  updateHighlightedLabelId,\n  updateImageData,\n} from 'store/labels/actionCreators';\nimport { AnnotationData, LabelPolygon, LabelsData } from 'store/labels/types';\nimport { GeneralSelector } from 'store/selectors/GeneralSelector';\nimport { LabelsSelector } from 'store/selectors/LabelsSelector';\nimport { DrawUtil } from 'utils/DrawUtil';\nimport { LineUtil } from 'utils/LineUtil';\nimport { MouseEventUtil } from 'utils/MouseEventUtil';\nimport { RectUtil } from 'utils/RectUtil';\nimport { RenderEngineUtil } from 'utils/RenderEngineUtil';\nimport uuid from 'uuid';\nimport { BaseRenderEngine } from './BaseRenderEngine';\n\nexport class PolygonRenderEngine extends BaseRenderEngine {\n  private config: RenderEngineConfig = new RenderEngineConfig();\n\n  // =================================================================================================================\n  // STATE\n  // =================================================================================================================\n\n  private activePath: IPoint[] = [];\n  private resizeAnchorIndex: number = null;\n  private suggestedAnchorPositionOnCanvas: IPoint = null;\n  private suggestedAnchorIndexInPolygon: number = null;\n\n  public constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n    this.labelType = LabelType.POLYGON;\n  }\n\n  // =================================================================================================================\n  // EVENT HANDLERS\n  // =================================================================================================================\n\n  public update(data: IEditorData, onLabelsDataChange?: (labelsData: LabelsData) => void): void {\n    if (!!data.event) {\n      switch (MouseEventUtil.getEventType(data.event)) {\n        case EventType.MOUSE_MOVE:\n          this.mouseMoveHandler(data);\n          break;\n        case EventType.MOUSE_UP:\n          this.mouseUpHandler(data, onLabelsDataChange);\n          break;\n        case EventType.MOUSE_DOWN:\n          this.mouseDownHandler(data, onLabelsDataChange);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  public mouseDownHandler(data: IEditorData, onLabelsDataChange): void {\n    const isMouseOverCanvas: boolean = RenderEngineUtil.isMouseOverCanvas(data);\n    if (isMouseOverCanvas) {\n      if (this.isCreationInProgress()) {\n        const isMouseOverStartAnchor: boolean = this.isMouseOverAnchor(\n          data.mousePositionOnViewPortContent,\n          this.activePath[0],\n        );\n        if (isMouseOverStartAnchor) {\n          this.addLabelAndFinishCreation(data, onLabelsDataChange);\n        } else {\n          this.updateActivelyCreatedLabel(data);\n        }\n      } else {\n        const polygonUnderMouse: LabelPolygon = this.getPolygonUnderMouse(data);\n        if (!!polygonUnderMouse) {\n          const anchorIndex: number = polygonUnderMouse.vertices.reduce(\n            (indexUnderMouse: number, anchor: IPoint, index: number) => {\n              if (indexUnderMouse === null) {\n                const anchorOnCanvas: IPoint = RenderEngineUtil.transferPointFromImageToViewPortContent(\n                  anchor,\n                  data,\n                );\n                if (this.isMouseOverAnchor(data.mousePositionOnViewPortContent, anchorOnCanvas)) {\n                  return index;\n                }\n              }\n              return indexUnderMouse;\n            },\n            null,\n          );\n\n          if (anchorIndex !== null) {\n            this.startExistingLabelResize(polygonUnderMouse.id, anchorIndex);\n          } else {\n            store.dispatch(updateActiveLabelId(polygonUnderMouse.id));\n            const isMouseOverNewAnchor: boolean = this.isMouseOverAnchor(\n              data.mousePositionOnViewPortContent,\n              this.suggestedAnchorPositionOnCanvas,\n            );\n            if (isMouseOverNewAnchor) {\n              this.addSuggestedAnchorToPolygonLabel(data);\n            }\n          }\n        } else {\n          this.updateActivelyCreatedLabel(data);\n        }\n      }\n    }\n  }\n\n  public mouseUpHandler(data: IEditorData, onLabelsDataChange): void {\n    if (this.isResizeInProgress()) this.endExistingLabelResize(data, onLabelsDataChange);\n  }\n\n  public mouseMoveHandler(data: IEditorData): void {\n    if (!!data.viewPortContentImageRect && !!data.mousePositionOnViewPortContent) {\n      const isOverImage: boolean = RenderEngineUtil.isMouseOverImage(data);\n      if (isOverImage && !this.isCreationInProgress()) {\n        const labelPolygon: LabelPolygon = this.getPolygonUnderMouse(data);\n        if (!!labelPolygon && !this.isResizeInProgress()) {\n          if (LabelsSelector.getHighlightedLabelId() !== labelPolygon.id) {\n            store.dispatch(updateHighlightedLabelId(labelPolygon.id));\n          }\n          const pathOnCanvas: IPoint[] = RenderEngineUtil.transferPolygonFromImageToViewPortContent(\n            labelPolygon.vertices,\n            data,\n          );\n          const linesOnCanvas: ILine[] = this.mapPointsToLines(\n            pathOnCanvas.concat(pathOnCanvas[0]),\n          );\n\n          for (let j = 0; j < linesOnCanvas.length; j++) {\n            if (this.isMouseOverLine(data.mousePositionOnViewPortContent, linesOnCanvas[j])) {\n              this.suggestedAnchorPositionOnCanvas = LineUtil.getCenter(linesOnCanvas[j]);\n              this.suggestedAnchorIndexInPolygon = j + 1;\n              break;\n            }\n          }\n        } else {\n          if (LabelsSelector.getHighlightedLabelId() !== null) {\n            store.dispatch(updateHighlightedLabelId(null));\n            this.discardSuggestedPoint();\n          }\n        }\n      }\n    }\n  }\n\n  // =================================================================================================================\n  // RENDERING\n  // =================================================================================================================\n\n  public render(data: IEditorData): void {\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    if (imageData) {\n      this.drawExistingLabels(data);\n      this.drawActivelyCreatedLabel(data);\n      this.drawActivelyResizeLabel(data);\n      this.updateCursorStyle(data);\n      this.drawSuggestedAnchor(data);\n    }\n  }\n\n  private updateCursorStyle(data: IEditorData) {\n    if (\n      !!this.canvas &&\n      !!data.mousePositionOnViewPortContent &&\n      !GeneralSelector.getImageDragModeStatus()\n    ) {\n      const isMouseOverCanvas: boolean = RenderEngineUtil.isMouseOverCanvas(data);\n      if (isMouseOverCanvas) {\n        if (this.isCreationInProgress()) {\n          const isMouseOverStartAnchor: boolean = this.isMouseOverAnchor(\n            data.mousePositionOnViewPortContent,\n            this.activePath[0],\n          );\n          if (isMouseOverStartAnchor && this.activePath.length > 2)\n            store.dispatch(updateCustomCursorStyle(CursorType.CLOSE));\n          else store.dispatch(updateCustomCursorStyle(CursorType.DEFAULT));\n        } else {\n          const anchorUnderMouse: IPoint = this.getAnchorUnderMouse(data);\n          const isMouseOverNewAnchor: boolean = this.isMouseOverAnchor(\n            data.mousePositionOnViewPortContent,\n            this.suggestedAnchorPositionOnCanvas,\n          );\n          if (!!isMouseOverNewAnchor) {\n            store.dispatch(updateCustomCursorStyle(CursorType.ADD));\n          } else if (this.isResizeInProgress()) {\n            store.dispatch(updateCustomCursorStyle(CursorType.MOVE));\n          } else if (!!anchorUnderMouse) {\n            store.dispatch(updateCustomCursorStyle(CursorType.MOVE));\n          } else {\n            RenderEngineUtil.wrapDefaultCursorStyleInCancel(data);\n          }\n        }\n        this.canvas.style.cursor = 'none';\n      } else {\n        this.canvas.style.cursor = 'default';\n      }\n    }\n  }\n\n  private drawActivelyCreatedLabel(data: IEditorData) {\n    const standardizedPoints: IPoint[] = this.activePath.map((point: IPoint) =>\n      RenderEngineUtil.setPointBetweenPixels(point),\n    );\n    const path = standardizedPoints.concat(data.mousePositionOnViewPortContent);\n    const lines: ILine[] = this.mapPointsToLines(path);\n\n    DrawUtil.drawPolygonWithFill(\n      this.canvas,\n      path,\n      DrawUtil.hexToRGB(this.config.lineActiveColor, 0.2),\n    );\n    lines.forEach((line: ILine) => {\n      DrawUtil.drawLine(\n        this.canvas,\n        line.start,\n        line.end,\n        this.config.lineActiveColor,\n        this.config.lineThickness,\n      );\n    });\n    this.mapPointsToAnchors(standardizedPoints).forEach((handleRect: IRect) => {\n      DrawUtil.drawRectWithFill(this.canvas, handleRect, this.config.activeAnchorColor);\n    });\n  }\n\n  private drawActivelyResizeLabel(data: IEditorData) {\n    const activeLabelPolygon: LabelPolygon = LabelsSelector.getActivePolygonLabel();\n    if (!!activeLabelPolygon && this.isResizeInProgress()) {\n      const snappedMousePosition: IPoint = RectUtil.snapPointToRect(\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      const polygonOnCanvas: IPoint[] = activeLabelPolygon.vertices.map(\n        (point: IPoint, index: number) => {\n          return index === this.resizeAnchorIndex\n            ? snappedMousePosition\n            : RenderEngineUtil.transferPointFromImageToViewPortContent(point, data);\n        },\n      );\n      this.drawPolygon(polygonOnCanvas, true);\n    }\n  }\n\n  private drawExistingLabels(data: IEditorData) {\n    const activeLabelId: string = LabelsSelector.getActiveLabelId();\n    const highlightedLabelId: string = LabelsSelector.getHighlightedLabelId();\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    imageData.labelPolygons.forEach((labelPolygon: LabelPolygon) => {\n      const isActive: boolean =\n        labelPolygon.id === activeLabelId || labelPolygon.id === highlightedLabelId;\n      const pathOnCanvas: IPoint[] = RenderEngineUtil.transferPolygonFromImageToViewPortContent(\n        labelPolygon.vertices,\n        data,\n      );\n      if (!(labelPolygon.id === activeLabelId && this.isResizeInProgress())) {\n        this.drawPolygon(pathOnCanvas, isActive);\n      }\n    });\n  }\n\n  private drawPolygon(polygon: IPoint[], isActive: boolean) {\n    const color: string = isActive ? this.config.lineActiveColor : this.config.lineInactiveColor;\n    const standardizedPoints: IPoint[] = polygon.map((point: IPoint) =>\n      RenderEngineUtil.setPointBetweenPixels(point),\n    );\n    if (isActive) {\n      DrawUtil.drawPolygonWithFill(this.canvas, standardizedPoints, DrawUtil.hexToRGB(color, 0.2));\n    }\n    DrawUtil.drawPolygon(this.canvas, standardizedPoints, color, this.config.lineThickness);\n    if (isActive) {\n      this.mapPointsToAnchors(standardizedPoints).forEach((handleRect: IRect) => {\n        DrawUtil.drawRectWithFill(this.canvas, handleRect, this.config.activeAnchorColor);\n      });\n    }\n  }\n\n  private drawSuggestedAnchor(data: IEditorData) {\n    if (this.suggestedAnchorPositionOnCanvas) {\n      const suggestedAnchorRect: IRect = RectUtil.getRectWithCenterAndSize(\n        this.suggestedAnchorPositionOnCanvas,\n        this.config.suggestedAnchorDetectionSize,\n      );\n      const isMouseOverSuggestedAnchor: boolean = RectUtil.isPointInside(\n        suggestedAnchorRect,\n        data.mousePositionOnViewPortContent,\n      );\n\n      if (isMouseOverSuggestedAnchor) {\n        const handleRect = RectUtil.getRectWithCenterAndSize(\n          this.suggestedAnchorPositionOnCanvas,\n          this.config.anchorSize,\n        );\n        DrawUtil.drawRectWithFill(this.canvas, handleRect, this.config.lineInactiveColor);\n      }\n    }\n  }\n\n  // =================================================================================================================\n  // CREATION\n  // =================================================================================================================\n\n  private updateActivelyCreatedLabel(data: IEditorData) {\n    if (this.isCreationInProgress()) {\n      const mousePositionSnapped: IPoint = RectUtil.snapPointToRect(\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      this.activePath.push(mousePositionSnapped);\n    } else {\n      const isMouseOverImage: boolean = RectUtil.isPointInside(\n        data.viewPortContentImageRect,\n        data.mousePositionOnViewPortContent,\n      );\n      if (isMouseOverImage) {\n        EditorActions.setViewPortActionsDisabledStatus(true);\n        this.activePath.push(data.mousePositionOnViewPortContent);\n        store.dispatch(updateActiveLabelId(null));\n      }\n    }\n  }\n\n  public cancelLabelCreation() {\n    this.activePath = [];\n    EditorActions.setViewPortActionsDisabledStatus(false);\n  }\n\n  private finishLabelCreation() {\n    this.activePath = [];\n    EditorActions.setViewPortActionsDisabledStatus(false);\n  }\n\n  public addLabelAndFinishCreation(data: IEditorData, onLabelsDataChange) {\n    if (this.isCreationInProgress() && this.activePath.length > 2) {\n      const polygonOnImage: IPoint[] = RenderEngineUtil.transferPolygonFromViewPortContentToImage(\n        this.activePath,\n        data,\n      );\n      this.addPolygonLabel(polygonOnImage, onLabelsDataChange);\n      this.finishLabelCreation();\n    }\n  }\n\n  private addPolygonLabel(polygon: IPoint[], onLabelsDataChange) {\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    const labelPolygon: LabelPolygon = {\n      id: uuid.v4(),\n      vertices: polygon,\n    };\n    imageData.labelPolygons.push(labelPolygon);\n    const { labelRects, labelPolygons } = imageData;\n    const labelsData: LabelsData = { labelRects, labelPolygons };\n    onLabelsDataChange(labelsData);\n    store.dispatch(updateImageData(imageData));\n    store.dispatch(updateActiveLabelId(labelPolygon.id));\n  }\n\n  // =================================================================================================================\n  // TRANSFER\n  // =================================================================================================================\n\n  private startExistingLabelResize(labelId: string, anchorIndex: number) {\n    store.dispatch(updateActiveLabelId(labelId));\n    this.resizeAnchorIndex = anchorIndex;\n    EditorActions.setViewPortActionsDisabledStatus(true);\n  }\n\n  private endExistingLabelResize(data: IEditorData, onLabelsDataChange) {\n    this.applyResizeToPolygonLabel(data, onLabelsDataChange);\n    this.resizeAnchorIndex = null;\n    EditorActions.setViewPortActionsDisabledStatus(false);\n  }\n\n  private applyResizeToPolygonLabel(data: IEditorData, onLabelsDataChange) {\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    const activeLabel: LabelPolygon = LabelsSelector.getActivePolygonLabel();\n    imageData.labelPolygons = imageData.labelPolygons.map((polygon: LabelPolygon) => {\n      if (polygon.id !== activeLabel.id) {\n        return polygon;\n      } else {\n        return {\n          ...polygon,\n          vertices: polygon.vertices.map((value: IPoint, index: number) => {\n            if (index !== this.resizeAnchorIndex) {\n              return value;\n            } else {\n              const snappedMousePosition: IPoint = RectUtil.snapPointToRect(\n                data.mousePositionOnViewPortContent,\n                data.viewPortContentImageRect,\n              );\n              return RenderEngineUtil.transferPointFromViewPortContentToImage(\n                snappedMousePosition,\n                data,\n              );\n            }\n          }),\n        };\n      }\n    });\n    const { labelPolygons, labelRects } = imageData;\n    const labelsData: LabelsData = { labelRects, labelPolygons };\n    onLabelsDataChange(labelsData);\n    store.dispatch(updateActiveLabelId(activeLabel.id));\n    store.dispatch(updateImageData(imageData));\n  }\n\n  private discardSuggestedPoint(): void {\n    this.suggestedAnchorIndexInPolygon = null;\n    this.suggestedAnchorPositionOnCanvas = null;\n  }\n\n  // =================================================================================================================\n  // UPDATE\n  // =================================================================================================================\n\n  private addSuggestedAnchorToPolygonLabel(data: IEditorData) {\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    const activeLabel: LabelPolygon = LabelsSelector.getActivePolygonLabel();\n    const newAnchorPositionOnImage: IPoint = RenderEngineUtil.transferPointFromViewPortContentToImage(\n      this.suggestedAnchorPositionOnCanvas,\n      data,\n    );\n    const insert = (arr, index, newItem) => [...arr.slice(0, index), newItem, ...arr.slice(index)];\n\n    const newImageData: AnnotationData = {\n      ...imageData,\n      labelPolygons: imageData.labelPolygons.map((polygon: LabelPolygon) => {\n        if (polygon.id !== activeLabel.id) {\n          return polygon;\n        } else {\n          return {\n            ...polygon,\n            vertices: insert(\n              polygon.vertices,\n              this.suggestedAnchorIndexInPolygon,\n              newAnchorPositionOnImage,\n            ),\n          };\n        }\n      }),\n    };\n\n    store.dispatch(updateImageData(newImageData));\n    this.startExistingLabelResize(activeLabel.id, this.suggestedAnchorIndexInPolygon);\n    this.discardSuggestedPoint();\n  }\n\n  // =================================================================================================================\n  // VALIDATORS\n  // =================================================================================================================\n\n  public isInProgress(): boolean {\n    return this.isCreationInProgress() || this.isResizeInProgress();\n  }\n\n  private isCreationInProgress(): boolean {\n    return this.activePath !== null && this.activePath.length !== 0;\n  }\n\n  private isResizeInProgress(): boolean {\n    return this.resizeAnchorIndex !== null;\n  }\n\n  private isMouseOverAnchor(mouse: IPoint, anchor: IPoint): boolean {\n    if (!mouse || !anchor) return null;\n    return RectUtil.isPointInside(\n      RectUtil.getRectWithCenterAndSize(anchor, this.config.anchorSize),\n      mouse,\n    );\n  }\n\n  private isMouseOverLine(mouse: IPoint, l: ILine): boolean {\n    const hoverReach: number = this.config.anchorHoverSize.width / 2;\n    const minX: number = Math.min(l.start.x, l.end.x);\n    const maxX: number = Math.max(l.start.x, l.end.x);\n    const minY: number = Math.min(l.start.y, l.end.y);\n    const maxY: number = Math.max(l.start.y, l.end.y);\n\n    return (\n      minX - hoverReach <= mouse.x &&\n      maxX + hoverReach >= mouse.x &&\n      minY - hoverReach <= mouse.y &&\n      maxY + hoverReach >= mouse.y &&\n      LineUtil.getDistanceFromLine(l, mouse) < hoverReach\n    );\n  }\n\n  // =================================================================================================================\n  // MAPPERS\n  // =================================================================================================================\n\n  private mapPointsToLines(points: IPoint[]): ILine[] {\n    const lines: ILine[] = [];\n    for (let i = 0; i < points.length - 1; i++) {\n      lines.push({ start: points[i], end: points[i + 1] });\n    }\n    return lines;\n  }\n\n  private mapPointsToAnchors(points: IPoint[]): IRect[] {\n    return points.map((point: IPoint) =>\n      RectUtil.getRectWithCenterAndSize(point, this.config.anchorSize),\n    );\n  }\n\n  // =================================================================================================================\n  // GETTERS\n  // =================================================================================================================\n\n  private getPolygonUnderMouse(data: IEditorData): LabelPolygon {\n    const labelPolygons: LabelPolygon[] = LabelsSelector.getImageData().labelPolygons;\n    for (let i = 0; i < labelPolygons.length; i++) {\n      const pathOnCanvas: IPoint[] = RenderEngineUtil.transferPolygonFromImageToViewPortContent(\n        labelPolygons[i].vertices,\n        data,\n      );\n      const linesOnCanvas: ILine[] = this.mapPointsToLines(pathOnCanvas.concat(pathOnCanvas[0]));\n\n      for (let j = 0; j < linesOnCanvas.length; j++) {\n        if (this.isMouseOverLine(data.mousePositionOnViewPortContent, linesOnCanvas[j]))\n          return labelPolygons[i];\n      }\n      for (let j = 0; j < pathOnCanvas.length; j++) {\n        if (this.isMouseOverAnchor(data.mousePositionOnViewPortContent, pathOnCanvas[j]))\n          return labelPolygons[i];\n      }\n    }\n    return null;\n  }\n\n  private getAnchorUnderMouse(data: IEditorData): IPoint {\n    const labelPolygons: LabelPolygon[] = LabelsSelector.getImageData().labelPolygons;\n    for (let i = 0; i < labelPolygons.length; i++) {\n      const pathOnCanvas: IPoint[] = RenderEngineUtil.transferPolygonFromImageToViewPortContent(\n        labelPolygons[i].vertices,\n        data,\n      );\n      for (let j = 0; j < pathOnCanvas.length; j++) {\n        if (this.isMouseOverAnchor(data.mousePositionOnViewPortContent, pathOnCanvas[j]))\n          return pathOnCanvas[j];\n      }\n    }\n    return null;\n  }\n}\n","import { IRect } from 'interfaces/IRect';\nimport { ViewPortActions } from 'logic/actions/ViewPortActions';\nimport { EditorModel } from 'model/EditorModel';\nimport { BaseRenderEngine } from './BaseRenderEngine';\n\nexport class PrimaryEditorRenderEngine extends BaseRenderEngine {\n  public constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n  }\n\n  public mouseMoveHandler(): void {}\n  public mouseDownHandler(): void {}\n  public mouseUpHandler(): void {}\n\n  public render(): void {\n    EditorModel.primaryRenderingEngine.drawImage(\n      EditorModel.image,\n      ViewPortActions.calculateViewPortContentImageRect(),\n    );\n  }\n\n  public drawImage(image: HTMLImageElement, imageRect: IRect) {\n    if (!!image && !!this.canvas) {\n      const ctx = this.canvas.getContext('2d');\n      ctx.drawImage(image, imageRect.x, imageRect.y, imageRect.width, imageRect.height);\n    }\n  }\n\n  isInProgress(): boolean {\n    return false;\n  }\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { LabelType } from 'interfaces/enums/LabelType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { RectAnchor } from 'interfaces/IRectAnchor';\nimport { EditorActions } from 'logic/actions/EditorActions';\nimport { RenderEngineConfig } from 'settings/RenderEngineConfig';\nimport { store } from 'store';\nimport { updateCustomCursorStyle } from 'store/general/actionCreators';\nimport {\n  updateActiveLabelId,\n  updateHighlightedLabelId,\n  updateImageData,\n} from 'store/labels/actionCreators';\nimport { AnnotationData, LabelRect, LabelsData } from 'store/labels/types';\nimport { GeneralSelector } from 'store/selectors/GeneralSelector';\nimport { LabelsSelector } from 'store/selectors/LabelsSelector';\nimport { DrawUtil } from 'utils/DrawUtil';\nimport { PointUtil } from 'utils/PointUtil';\nimport { RectUtil } from 'utils/RectUtil';\nimport { RenderEngineUtil } from 'utils/RenderEngineUtil';\nimport uuid from 'uuid';\nimport { BaseRenderEngine } from './BaseRenderEngine';\n\nexport class RectRenderEngine extends BaseRenderEngine {\n  private config: RenderEngineConfig = new RenderEngineConfig();\n\n  // =================================================================================================================\n  // STATE\n  // =================================================================================================================\n\n  private startCreateRectPoint: IPoint;\n  private startResizeRectAnchor: RectAnchor;\n\n  public constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n    this.labelType = LabelType.RECTANGLE;\n  }\n\n  // =================================================================================================================\n  // EVENT HANDLERS\n  // =================================================================================================================\n\n  public mouseDownHandler = (data: IEditorData) => {\n    const isMouseOverImage: boolean = RenderEngineUtil.isMouseOverImage(data);\n    const isMouseOverCanvas: boolean = RenderEngineUtil.isMouseOverCanvas(data);\n    if (isMouseOverCanvas) {\n      const rectUnderMouse: LabelRect = this.getRectUnderMouse(data);\n      if (!!rectUnderMouse) {\n        const rect: IRect = this.calculateRectRelativeToActiveImage(rectUnderMouse.rect, data);\n        const anchorUnderMouse: RectAnchor = this.getAnchorUnderMouseByRect(\n          rect,\n          data.mousePositionOnViewPortContent,\n          data.viewPortContentImageRect,\n        );\n        if (!!anchorUnderMouse) {\n          store.dispatch(updateActiveLabelId(rectUnderMouse.id));\n          this.startRectResize(anchorUnderMouse);\n        } else {\n          if (!!LabelsSelector.getHighlightedLabelId())\n            store.dispatch(updateActiveLabelId(LabelsSelector.getHighlightedLabelId()));\n          else this.startRectCreation(data.mousePositionOnViewPortContent);\n        }\n      } else if (isMouseOverImage) {\n        this.startRectCreation(data.mousePositionOnViewPortContent);\n      }\n    }\n  };\n\n  public mouseUpHandler = (\n    data: IEditorData,\n    onLabelsDataChange?: (labelsData: LabelsData) => void,\n  ) => {\n    if (!!data.viewPortContentImageRect) {\n      const mousePositionSnapped: IPoint = RectUtil.snapPointToRect(\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      const activeLabelRect: LabelRect = LabelsSelector.getActiveRectLabel();\n\n      if (\n        !!this.startCreateRectPoint &&\n        !PointUtil.equals(this.startCreateRectPoint, mousePositionSnapped)\n      ) {\n        const minX: number = Math.min(this.startCreateRectPoint.x, mousePositionSnapped.x);\n        const minY: number = Math.min(this.startCreateRectPoint.y, mousePositionSnapped.y);\n        const maxX: number = Math.max(this.startCreateRectPoint.x, mousePositionSnapped.x);\n        const maxY: number = Math.max(this.startCreateRectPoint.y, mousePositionSnapped.y);\n\n        const rect = {\n          x: minX,\n          y: minY,\n          width: maxX - minX,\n          height: maxY - minY,\n        };\n        this.addRectLabel(\n          RenderEngineUtil.transferRectFromImageToViewPortContent(rect, data),\n          onLabelsDataChange,\n        );\n      }\n\n      if (!!this.startResizeRectAnchor && !!activeLabelRect) {\n        const rect: IRect = this.calculateRectRelativeToActiveImage(activeLabelRect.rect, data);\n        const startAnchorPosition: IPoint = PointUtil.add(\n          this.startResizeRectAnchor.position,\n          data.viewPortContentImageRect,\n        );\n        const delta: IPoint = PointUtil.subtract(mousePositionSnapped, startAnchorPosition);\n        const resizeRect: IRect = RectUtil.resizeRect(rect, this.startResizeRectAnchor.type, delta);\n        const scale: number = RenderEngineUtil.calculateImageScale(data);\n        const scaledRect: IRect = RectUtil.scaleRect(resizeRect, scale);\n\n        const imageData = LabelsSelector.getImageData();\n        imageData.labelRects = imageData.labelRects.map((labelRect: LabelRect) => {\n          if (labelRect.id === activeLabelRect.id) {\n            return {\n              ...labelRect,\n              rect: scaledRect,\n            };\n          }\n          return labelRect;\n        });\n        const { labelRects, labelPolygons } = imageData;\n        const labelsData: LabelsData = { labelRects, labelPolygons };\n        onLabelsDataChange(labelsData);\n        store.dispatch(updateImageData(imageData));\n      }\n    }\n    this.endRectTransformation();\n  };\n\n  public mouseMoveHandler = (data: IEditorData) => {\n    if (!!data.viewPortContentImageRect && !!data.mousePositionOnViewPortContent) {\n      const isOverImage: boolean = RenderEngineUtil.isMouseOverImage(data);\n      if (isOverImage && !this.startResizeRectAnchor) {\n        const labelRect: LabelRect = this.getRectUnderMouse(data);\n        if (!!labelRect && !this.isInProgress()) {\n          if (LabelsSelector.getHighlightedLabelId() !== labelRect.id) {\n            store.dispatch(updateHighlightedLabelId(labelRect.id));\n          }\n        } else {\n          if (LabelsSelector.getHighlightedLabelId() !== null) {\n            store.dispatch(updateHighlightedLabelId(null));\n          }\n        }\n      }\n    }\n  };\n\n  // =================================================================================================================\n  // RENDERING\n  // =================================================================================================================\n\n  public render(data: IEditorData) {\n    const activeLabelId: string = LabelsSelector.getActiveLabelId();\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n\n    if (imageData) {\n      imageData.labelRects.forEach((labelRect: LabelRect) => {\n        const displayAsActive: boolean = labelRect.id === activeLabelId;\n        displayAsActive\n          ? this.drawActiveRect(labelRect, data)\n          : this.drawInactiveRect(labelRect, data);\n      });\n      this.drawCurrentlyCreatedRect(\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      this.updateCursorStyle(data);\n    }\n  }\n\n  private drawCurrentlyCreatedRect(mousePosition: IPoint, imageRect: IRect) {\n    if (!!this.startCreateRectPoint) {\n      const mousePositionSnapped: IPoint = RectUtil.snapPointToRect(mousePosition, imageRect);\n      const activeRect: IRect = {\n        x: this.startCreateRectPoint.x,\n        y: this.startCreateRectPoint.y,\n        width: mousePositionSnapped.x - this.startCreateRectPoint.x,\n        height: mousePositionSnapped.y - this.startCreateRectPoint.y,\n      };\n      const activeRectBetweenPixels = RenderEngineUtil.setRectBetweenPixels(activeRect);\n      DrawUtil.drawRect(\n        this.canvas,\n        activeRectBetweenPixels,\n        this.config.lineActiveColor,\n        this.config.lineThickness,\n      );\n    }\n  }\n\n  private drawInactiveRect(labelRect: LabelRect, data: IEditorData) {\n    const rectOnImage: IRect = RenderEngineUtil.transferRectFromViewPortContentToImage(\n      labelRect.rect,\n      data,\n    );\n    this.renderRect(rectOnImage, true);\n  }\n\n  private drawActiveRect(labelRect: LabelRect, data: IEditorData) {\n    let rect: IRect = this.calculateRectRelativeToActiveImage(labelRect.rect, data);\n    if (!!this.startResizeRectAnchor) {\n      const startAnchorPosition: IPoint = PointUtil.add(\n        this.startResizeRectAnchor.position,\n        data.viewPortContentImageRect,\n      );\n      const endAnchorPositionSnapped: IPoint = RectUtil.snapPointToRect(\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      const delta = PointUtil.subtract(endAnchorPositionSnapped, startAnchorPosition);\n      rect = RectUtil.resizeRect(rect, this.startResizeRectAnchor.type, delta);\n    }\n    const rectOnImage: IRect = RectUtil.translate(rect, data.viewPortContentImageRect);\n    this.renderRect(rectOnImage, true);\n  }\n\n  private renderRect(rectOnImage: IRect, isActive: boolean) {\n    const rectBetweenPixels = RenderEngineUtil.setRectBetweenPixels(rectOnImage);\n    const lineColor: string = isActive\n      ? this.config.lineActiveColor\n      : this.config.lineInactiveColor;\n    DrawUtil.drawRect(this.canvas, rectBetweenPixels, lineColor, this.config.lineThickness);\n    if (isActive) {\n      const handleCenters: IPoint[] = RectUtil.mapRectToAnchors(rectOnImage).map(\n        (rectAnchor: RectAnchor) => rectAnchor.position,\n      );\n      handleCenters.forEach((center: IPoint) => {\n        const handleRect: IRect = RectUtil.getRectWithCenterAndSize(center, this.config.anchorSize);\n        const handleRectBetweenPixels: IRect = RenderEngineUtil.setRectBetweenPixels(handleRect);\n        DrawUtil.drawRectWithFill(\n          this.canvas,\n          handleRectBetweenPixels,\n          this.config.activeAnchorColor,\n        );\n      });\n    }\n  }\n\n  private updateCursorStyle(data: IEditorData) {\n    if (\n      !!this.canvas &&\n      !!data.mousePositionOnViewPortContent &&\n      !GeneralSelector.getImageDragModeStatus()\n    ) {\n      const rectAnchorUnderMouse: RectAnchor = this.getAnchorUnderMouse(data);\n      if (!!rectAnchorUnderMouse || !!this.startResizeRectAnchor) {\n        store.dispatch(updateCustomCursorStyle(CursorType.MOVE));\n        return;\n      } else if (RenderEngineUtil.isMouseOverCanvas(data)) {\n        if (!RenderEngineUtil.isMouseOverImage(data) && !!this.startCreateRectPoint)\n          store.dispatch(updateCustomCursorStyle(CursorType.MOVE));\n        else RenderEngineUtil.wrapDefaultCursorStyleInCancel(data);\n        this.canvas.style.cursor = 'none';\n      } else {\n        this.canvas.style.cursor = 'default';\n      }\n    }\n  }\n\n  // =================================================================================================================\n  // HELPERS\n  // =================================================================================================================\n\n  public isInProgress(): boolean {\n    return !!this.startCreateRectPoint || !!this.startResizeRectAnchor;\n  }\n\n  private calculateRectRelativeToActiveImage(rect: IRect, data: IEditorData): IRect {\n    const scale: number = RenderEngineUtil.calculateImageScale(data);\n    return RectUtil.scaleRect(rect, 1 / scale);\n  }\n\n  private addRectLabel = (rect: IRect, onLabelsDataChange) => {\n    const imageData: AnnotationData = LabelsSelector.getImageData();\n    const labelRect: LabelRect = {\n      id: uuid.v4(),\n      rect,\n    };\n    imageData.labelRects.push(labelRect);\n    const { labelRects, labelPolygons } = imageData;\n    const labelsData: LabelsData = { labelRects, labelPolygons };\n    onLabelsDataChange(labelsData);\n    store.dispatch(updateImageData(imageData));\n    store.dispatch(updateActiveLabelId(labelRect.id));\n  };\n\n  private getRectUnderMouse(data: IEditorData): LabelRect {\n    const activeRectLabel: LabelRect = LabelsSelector.getActiveRectLabel();\n    if (!!activeRectLabel && this.isMouseOverRectEdges(activeRectLabel.rect, data)) {\n      return activeRectLabel;\n    }\n\n    const labelRects: LabelRect[] = LabelsSelector.getImageData().labelRects;\n    for (let i = 0; i < labelRects.length; i++) {\n      if (this.isMouseOverRectEdges(labelRects[i].rect, data)) {\n        return labelRects[i];\n      }\n    }\n    return null;\n  }\n\n  private isMouseOverRectEdges(rect: IRect, data: IEditorData): boolean {\n    const rectOnImage: IRect = RectUtil.translate(\n      this.calculateRectRelativeToActiveImage(rect, data),\n      data.viewPortContentImageRect,\n    );\n\n    const outerRectDelta: IPoint = {\n      x: this.config.anchorHoverSize.width / 2,\n      y: this.config.anchorHoverSize.height / 2,\n    };\n    const outerRect: IRect = RectUtil.expand(rectOnImage, outerRectDelta);\n\n    const innerRectDelta: IPoint = {\n      x: -this.config.anchorHoverSize.width / 2,\n      y: -this.config.anchorHoverSize.height / 2,\n    };\n    const innerRect: IRect = RectUtil.expand(rectOnImage, innerRectDelta);\n\n    return (\n      RectUtil.isPointInside(outerRect, data.mousePositionOnViewPortContent) &&\n      !RectUtil.isPointInside(innerRect, data.mousePositionOnViewPortContent)\n    );\n  }\n\n  private getAnchorUnderMouseByRect(\n    rect: IRect,\n    mousePosition: IPoint,\n    imageRect: IRect,\n  ): RectAnchor {\n    const rectAnchors: RectAnchor[] = RectUtil.mapRectToAnchors(rect);\n    for (let i = 0; i < rectAnchors.length; i++) {\n      const anchorRect: IRect = RectUtil.translate(\n        RectUtil.getRectWithCenterAndSize(rectAnchors[i].position, this.config.anchorHoverSize),\n        imageRect,\n      );\n      if (!!mousePosition && RectUtil.isPointInside(anchorRect, mousePosition)) {\n        return rectAnchors[i];\n      }\n    }\n    return null;\n  }\n\n  private getAnchorUnderMouse(data: IEditorData): RectAnchor {\n    const labelRects: LabelRect[] = LabelsSelector.getImageData().labelRects;\n    for (let i = 0; i < labelRects.length; i++) {\n      const rect: IRect = this.calculateRectRelativeToActiveImage(labelRects[i].rect, data);\n      const rectAnchor = this.getAnchorUnderMouseByRect(\n        rect,\n        data.mousePositionOnViewPortContent,\n        data.viewPortContentImageRect,\n      );\n      if (!!rectAnchor) return rectAnchor;\n    }\n    return null;\n  }\n\n  private startRectCreation(mousePosition: IPoint) {\n    this.startCreateRectPoint = mousePosition;\n    store.dispatch(updateActiveLabelId(null));\n    EditorActions.setViewPortActionsDisabledStatus(true);\n  }\n\n  private startRectResize(activatedAnchor: RectAnchor) {\n    this.startResizeRectAnchor = activatedAnchor;\n    EditorActions.setViewPortActionsDisabledStatus(true);\n  }\n\n  private endRectTransformation() {\n    this.startCreateRectPoint = null;\n    this.startResizeRectAnchor = null;\n    EditorActions.setViewPortActionsDisabledStatus(false);\n  }\n}\n","import React from 'react';\nimport { IPoint } from '../interfaces/IPoint';\nimport { IRect } from '../interfaces/IRect';\nimport { ISize } from '../interfaces/ISize';\n\nexport class CanvasUtil {\n  public static getMousePositionOnCanvasFromEvent(\n    event: React.MouseEvent<HTMLCanvasElement, MouseEvent> | MouseEvent,\n    canvas: HTMLCanvasElement,\n  ): IPoint {\n    if (!!canvas && !!event) {\n      const canvasRect: ClientRect | DOMRect = canvas.getBoundingClientRect();\n      return {\n        x: event.clientX - canvasRect.left,\n        y: event.clientY - canvasRect.top,\n      };\n    }\n    return null;\n  }\n\n  public static getClientRect(canvas: HTMLCanvasElement): IRect {\n    if (!!canvas) {\n      const canvasRect: ClientRect | DOMRect = canvas.getBoundingClientRect();\n      return {\n        x: canvasRect.left,\n        y: canvasRect.top,\n        width: canvasRect.width,\n        height: canvasRect.height,\n      };\n    }\n    return null;\n  }\n\n  public static getSize(canvas: HTMLCanvasElement): ISize {\n    if (!!canvas) {\n      const canvasRect: ClientRect | DOMRect = canvas.getBoundingClientRect();\n      return {\n        width: canvasRect.width,\n        height: canvasRect.height,\n      };\n    }\n    return null;\n  }\n}\n","import { CursorType } from 'interfaces/enums/CursorType';\nimport { LabelType } from 'interfaces/enums/LabelType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { IPoint } from 'interfaces/IPoint';\nimport { IRect } from 'interfaces/IRect';\nimport { ISize } from 'interfaces/ISize';\nimport { ViewPortHelper } from 'logic/helpers/ViewPortHelper';\nimport { PolygonRenderEngine } from 'logic/render/PolygonRenderEngine';\nimport { PrimaryEditorRenderEngine } from 'logic/render/PrimaryEditorRenderEngine';\nimport { RectRenderEngine } from 'logic/render/RectRenderEngine';\nimport { EditorModel } from 'model/EditorModel';\nimport React from 'react';\nimport { GeneralSelector } from 'store/selectors/GeneralSelector';\nimport { CanvasUtil } from 'utils/CanvasUtil';\nimport { DrawUtil } from 'utils/DrawUtil';\nimport { ImageUtil } from 'utils/ImageUtil';\nimport { PointUtil } from 'utils/PointUtil';\nimport { RectUtil } from 'utils/RectUtil';\nimport { ViewPortActions } from './ViewPortActions';\n\nexport class EditorActions {\n  // =================================================================================================================\n  // RENDER ENGINES\n  // =================================================================================================================\n\n  public static mountSupportRenderingEngine(activeLabelType: LabelType) {\n    EditorModel.supportRenderingEngine =\n      activeLabelType === LabelType.RECTANGLE\n        ? new RectRenderEngine(EditorModel.canvas)\n        : new PolygonRenderEngine(EditorModel.canvas);\n  }\n\n  public static swapSupportRenderingEngine(activeLabelType: LabelType) {\n    EditorActions.mountSupportRenderingEngine(activeLabelType);\n  }\n\n  public static mountRenderEnginesAndHelpers(activeLabelType: LabelType) {\n    EditorModel.viewPortHelper = new ViewPortHelper();\n    EditorModel.primaryRenderingEngine = new PrimaryEditorRenderEngine(EditorModel.canvas);\n    EditorActions.mountSupportRenderingEngine(activeLabelType);\n  }\n\n  // =================================================================================================================\n  // RENDER\n  // =================================================================================================================\n\n  public static fullRender() {\n    DrawUtil.clearCanvas(EditorModel.canvas);\n    EditorModel?.primaryRenderingEngine?.render();\n    EditorModel?.supportRenderingEngine?.render(EditorActions.getEditorData());\n  }\n\n  // =================================================================================================================\n  // SETTERS\n  // =================================================================================================================\n\n  public static setLoadingStatus(status: boolean) {\n    EditorModel.isLoading = status;\n  }\n  public static setActiveImage(image: HTMLImageElement) {\n    EditorModel.image = image;\n  }\n\n  public static setViewPortActionsDisabledStatus(status: boolean) {\n    EditorModel.viewPortActionsDisabled = status;\n  }\n\n  // =================================================================================================================\n  // GETTERS\n  // =================================================================================================================\n\n  public static getEditorData(event?: Event): IEditorData {\n    return {\n      mousePositionOnViewPortContent: EditorModel.mousePositionOnViewPortContent,\n      viewPortContentSize: CanvasUtil.getSize(EditorModel.canvas),\n      event: event,\n      zoom: GeneralSelector.getZoom(),\n      viewPortSize: EditorModel.viewPortSize,\n      defaultRenderImageRect: EditorModel.defaultRenderImageRect,\n      viewPortContentImageRect: ViewPortActions.calculateViewPortContentImageRect(),\n      realImageSize: ImageUtil.getSize(EditorModel.image),\n      absoluteViewPortContentScrollPosition: ViewPortActions.getAbsoluteScrollPosition(),\n    };\n  }\n\n  // =================================================================================================================\n  // HELPERS\n  // =================================================================================================================\n\n  public static updateMousePositionIndicator(\n    event: React.MouseEvent<HTMLCanvasElement, MouseEvent> | MouseEvent,\n  ) {\n    if (!EditorModel.image || !EditorModel.canvas) {\n      EditorModel.mousePositionIndicator.style.display = 'none';\n      EditorModel.cursor.style.display = 'none';\n      return;\n    }\n\n    const mousePositionOverViewPortContent: IPoint = CanvasUtil.getMousePositionOnCanvasFromEvent(\n      event,\n      EditorModel.canvas,\n    );\n    const viewPortContentScrollPosition: IPoint = ViewPortActions.getAbsoluteScrollPosition();\n    const viewPortContentImageRect: IRect = ViewPortActions.calculateViewPortContentImageRect();\n    const mousePositionOverViewPort: IPoint = PointUtil.subtract(\n      mousePositionOverViewPortContent,\n      viewPortContentScrollPosition,\n    );\n    const isMouseOverImage: boolean = RectUtil.isPointInside(\n      viewPortContentImageRect,\n      mousePositionOverViewPortContent,\n    );\n    const isMouseOverViewPort: boolean = RectUtil.isPointInside(\n      { x: 0, y: 0, ...EditorModel.viewPortSize },\n      mousePositionOverViewPort,\n    );\n\n    if (isMouseOverViewPort && !GeneralSelector.getPreventCustomCursorStatus()) {\n      EditorModel.cursor.style.left = mousePositionOverViewPort.x + 'px';\n      EditorModel.cursor.style.top = mousePositionOverViewPort.y + 'px';\n      EditorModel.cursor.style.display = 'block';\n\n      if (\n        isMouseOverImage &&\n        ![CursorType.GRAB, CursorType.GRABBING].includes(GeneralSelector.getCustomCursorStyle())\n      ) {\n        const imageSize: ISize = ImageUtil.getSize(EditorModel.image);\n        const scale: number = imageSize.width / viewPortContentImageRect.width;\n        const mousePositionOverImage: IPoint = PointUtil.multiply(\n          PointUtil.subtract(mousePositionOverViewPortContent, viewPortContentImageRect),\n          scale,\n        );\n        const text: string =\n          'x: ' +\n          Math.round(mousePositionOverImage.x) +\n          ', y: ' +\n          Math.round(mousePositionOverImage.y);\n\n        EditorModel.mousePositionIndicator.innerHTML = text;\n        EditorModel.mousePositionIndicator.style.left = mousePositionOverViewPort.x + 15 + 'px';\n        EditorModel.mousePositionIndicator.style.top = mousePositionOverViewPort.y + 15 + 'px';\n        EditorModel.mousePositionIndicator.style.display = 'block';\n      } else {\n        EditorModel.mousePositionIndicator.style.display = 'none';\n      }\n    } else {\n      EditorModel.cursor.style.display = 'none';\n      EditorModel.mousePositionIndicator.style.display = 'none';\n    }\n  }\n}\n","export class FileUtil {\n  public static loadImage(\n    fileData: File,\n    onSuccess: (image: HTMLImageElement) => any,\n    onFailure: () => any,\n  ): any {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(fileData);\n      const image = new Image();\n      image.src = url;\n      image.onload = () => {\n        onSuccess(image);\n        resolve();\n      };\n      image.onerror = () => {\n        onFailure();\n        reject();\n      };\n    });\n  }\n\n  public static loadLabelsList(\n    fileData: File,\n    onSuccess: (labels: string[]) => any,\n    onFailure: () => any,\n  ) {\n    const reader = new FileReader();\n    reader.readAsText(fileData);\n    reader.onloadend = function (evt: any) {\n      const contents: string = evt.target.result;\n      onSuccess(contents.split(/[\\r\\n]/));\n    };\n    reader.onerror = () => onFailure();\n  }\n}\n","import { EventType } from 'interfaces/enums/EventType';\nimport { LabelType } from 'interfaces/enums/LabelType';\nimport { IEditorData } from 'interfaces/IEditorData';\nimport { EditorActions } from 'logic/actions/EditorActions';\nimport { ViewPortActions } from 'logic/actions/ViewPortActions';\nimport { EditorModel } from 'model/EditorModel';\nimport { useEffect } from 'react';\nimport { AnnotationData, LabelsData } from 'store/labels/types';\nimport { CanvasUtil } from 'utils/CanvasUtil';\nimport { FileUtil } from 'utils/FileUtil';\n\ninterface IProps {\n  annotationType: LabelType;\n  imageData: AnnotationData;\n  imageDragMode: boolean;\n  onLabelsDataChange?: (labelsData: LabelsData) => void;\n}\n\nconst NOOP = () => {};\n\nconst useCanvasListeners = ({\n  imageData,\n  annotationType,\n  imageDragMode,\n  onLabelsDataChange = NOOP,\n}: IProps) => {\n  useEffect(() => {\n    const update = (event: MouseEvent) => {\n      const editorData: IEditorData = EditorActions.getEditorData(event);\n      EditorModel.mousePositionOnViewPortContent = CanvasUtil.getMousePositionOnCanvasFromEvent(\n        event,\n        EditorModel.canvas,\n      );\n\n      EditorModel.primaryRenderingEngine.update(editorData);\n\n      if (imageDragMode) {\n        EditorModel.viewPortHelper.update(editorData);\n      } else {\n        EditorModel?.supportRenderingEngine.update(editorData, onLabelsDataChange);\n      }\n\n      EditorActions.updateMousePositionIndicator(event);\n      EditorActions.fullRender();\n    };\n\n    window.addEventListener(EventType.MOUSE_MOVE, update);\n    window.addEventListener(EventType.MOUSE_UP, update);\n    EditorModel.canvas.addEventListener(EventType.MOUSE_DOWN, update);\n\n    return () => {\n      window.removeEventListener(EventType.MOUSE_MOVE, update);\n      window.removeEventListener(EventType.MOUSE_UP, update);\n      EditorModel.canvas.removeEventListener(EventType.MOUSE_DOWN, update);\n    };\n  }, [imageDragMode, onLabelsDataChange]);\n\n  useEffect(() => {\n    const updateModelAndRender = () => {\n      ViewPortActions.updateViewPortSize();\n      ViewPortActions.updateDefaultViewPortImageRect();\n      ViewPortActions.resizeViewPortContent();\n      EditorActions.fullRender();\n    };\n\n    const saveLoadedImage = (image: HTMLImageElement, imageData: AnnotationData) => {\n      imageData.loadStatus = true;\n\n      EditorActions.setActiveImage(image);\n      EditorActions.setLoadingStatus(false);\n      updateModelAndRender();\n    };\n\n    // Load Image\n    if (imageData.loadStatus) {\n      updateModelAndRender();\n    } else {\n      if (!EditorModel.isLoading) {\n        EditorActions.setLoadingStatus(true);\n        const saveLoadedImagePartial = (image: HTMLImageElement) =>\n          saveLoadedImage(image, imageData);\n        FileUtil.loadImage(imageData.fileData, saveLoadedImagePartial, NOOP);\n      }\n    }\n  }, [imageData]);\n\n  useEffect(() => {\n    EditorActions.mountRenderEnginesAndHelpers(annotationType);\n  }, [annotationType]);\n};\n\nexport default useCanvasListeners;\n","import { IPoint } from 'interfaces/IPoint';\nimport { EditorActions } from 'logic/actions/EditorActions';\nimport { ViewPortActions } from 'logic/actions/ViewPortActions';\nimport { EditorModel } from 'model/EditorModel';\nimport { useEffect, useRef } from 'react';\nimport { GeneralSelector } from 'store/selectors/GeneralSelector';\n\nconst DEFAULT_SCROLL_POSITION = { x: 0.5, y: 0.5 };\n\nconst useCanvasZoom = (zoom: number) => {\n  const isMounted = useRef(false);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      if (EditorModel.viewPortActionsDisabled) return;\n\n      const currentZoom: number = GeneralSelector.getZoom();\n      const currentRelativeScrollPosition: IPoint = ViewPortActions.getRelativeScrollPosition();\n      const nextRelativeScrollPosition =\n        currentZoom === 1 ? DEFAULT_SCROLL_POSITION : currentRelativeScrollPosition;\n      ViewPortActions.setZoom(zoom);\n      ViewPortActions.resizeViewPortContent();\n\n      ViewPortActions.setScrollPosition(\n        ViewPortActions.calculateAbsoluteScrollPosition(nextRelativeScrollPosition),\n      );\n\n      EditorActions.fullRender();\n    } else {\n      isMounted.current = true;\n    }\n  }, [zoom]);\n};\n\nexport default useCanvasZoom;\n","import { IconPaths } from 'components/Icons';\nimport Icon from 'components/Icons/Icon';\nimport { useCanvasListeners, useCanvasZoom } from 'hooks';\nimport { ICanvasAnnotation } from 'interfaces';\nimport { CursorType } from 'interfaces/enums';\nimport isEqual from 'lodash.isequal';\nimport { EditorModel } from 'model';\nimport React, { useEffect, useMemo } from 'react';\nimport Scrollbars from 'react-custom-scrollbars';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { AppState } from 'store';\nimport { updateImageDragModeStatus } from 'store/general/actionCreators';\nimport {\n  updateActiveLabelId,\n  updateActiveLabelType,\n  updateImageData,\n  updateLabels,\n} from 'store/labels/actionCreators';\nimport { AnnotationData } from 'store/labels/types';\nimport styled from 'styled-components';\nimport { ifProp } from 'styled-tools';\nimport 'tailwindcss/dist/base.css';\nimport tw from 'twin.macro';\n\nconst selector = (state: AppState) => ({\n  customCursorStyle: state.general.customCursorStyle,\n  imageDragMode: state.general.imageDragMode,\n});\n\nconst onContextMenu = (event: React.MouseEvent<HTMLCanvasElement>) => event.preventDefault();\n\nconst NOOP = () => {};\n\nconst CanvasAnnotation: React.FC<ICanvasAnnotation> = ({\n  annotationType,\n  className,\n  imageFile,\n  labels,\n  onChange = NOOP,\n  zoom = 1,\n  isImageDrag = false,\n}) => {\n  const imageData: AnnotationData = useMemo(\n    () => ({\n      fileData: imageFile,\n      loadStatus: false,\n      ...labels,\n    }),\n    [imageFile, labels],\n  );\n\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(updateImageData(imageData));\n  }, [dispatch, imageData]);\n\n  useEffect(() => {\n    dispatch(updateLabels(labels));\n  }, [dispatch, labels]);\n\n  useEffect(() => {\n    dispatch(updateImageDragModeStatus(isImageDrag));\n  }, [dispatch, isImageDrag]);\n\n  useEffect(() => {\n    dispatch(updateActiveLabelType(annotationType));\n    dispatch(updateActiveLabelId(null));\n  }, [dispatch, annotationType]);\n\n  useCanvasZoom(zoom);\n\n  const { customCursorStyle } = useSelector(selector, isEqual);\n\n  useCanvasListeners({\n    imageData,\n    annotationType,\n    imageDragMode: isImageDrag,\n    onLabelsDataChange: onChange,\n  });\n\n  return (\n    imageData && (\n      <Editor className={className} ref={ref => (EditorModel.editor = ref)} draggable={false}>\n        <Scrollbars\n          ref={ref => (EditorModel.viewPortScrollbars = ref)}\n          renderTrackHorizontal={props => <NoCursorTrack {...props} />}\n          renderTrackVertical={props => <NoCursorTrack {...props} />}\n          draggable={false}>\n          <Canvas\n            ref={ref => (EditorModel.canvas = ref)}\n            draggable={false}\n            onContextMenu={onContextMenu}\n          />\n        </Scrollbars>\n        <MouseIndicator ref={ref => (EditorModel.mousePositionIndicator = ref)} draggable={false} />\n        <Cursor\n          isGrabbing={customCursorStyle === CursorType.GRABBING}\n          isTransform={customCursorStyle !== CursorType.DEFAULT}\n          ref={ref => (EditorModel.cursor = ref)}\n          draggable={false}>\n          <Icon d={IconPaths[customCursorStyle]} />\n        </Cursor>\n      </Editor>\n    )\n  );\n};\n\nconst Editor = styled.div`\n  ${tw`w-full h-full relative`}\n`;\n\nconst Canvas = styled.canvas`\n  ${tw`absolute cursor-none`}\n`;\n\nconst MouseIndicator = styled.div`\n  ${tw`select-none pointer-events-none`}\n  ${tw`absolute text-white opacity-75 p-1`}\n  ${tw`bg-gray-700 z-50`}\n`;\n\ninterface ICursor {\n  readonly isTransform: boolean;\n  readonly isGrabbing: boolean;\n}\n\nconst Cursor = styled.div<ICursor>`\n  ${tw`absolute w-2 h-2 text-white fill-current`}\n  ${tw`pointer-events-none z-40`}\n  ${tw`border-white bg-white rounded-full`}\n  ${tw`transition-transform ease-in-out duration-200`}\n  ${ifProp(`isTransform`, tw`border bg-transparent transform scale-350`)}\n  ${ifProp(`isGrabbing`, tw`scale-250`)}\n`;\n\nconst NoCursorTrack = styled.div`\n  ${tw`pointer-events-none cursor-none`}\n`;\n\nexport const className = Editor;\nexport default CanvasAnnotation;\n","import { ICanvasAnnotation } from 'interfaces';\nimport { LabelType } from 'interfaces/enums';\nimport React from 'react';\nimport { Provider } from 'react-redux';\nimport { AppInitializer, store } from 'store';\nimport CanvasAnnotation, { className } from './components/CanvasAnnotation';\n\nAppInitializer.init();\n\nconst ReactCanvasAnnotation = (props: ICanvasAnnotation) => (\n  <Provider store={store}>\n    <CanvasAnnotation {...props} />\n  </Provider>\n);\n\nconst LABEL_TYPE: { [key in LabelType]: LabelType } = {\n  [LabelType.POLYGON]: LabelType.POLYGON,\n  [LabelType.RECTANGLE]: LabelType.RECTANGLE,\n};\n\nexport { ReactCanvasAnnotation, LABEL_TYPE, className };\n","import React, { useCallback, useState } from 'react';\nimport { LABEL_TYPE } from 'react-canvas-annotation';\nimport styled from 'styled-components';\nimport tw from 'twin.macro';\nimport OptionBox from './OptionBox.react';\n\nconst TABS = [LABEL_TYPE.RECTANGLE, LABEL_TYPE.POLYGON];\n\nconst TypePicker = ({ onChange }) => {\n  const [tabEnabled, setTabEnabled] = useState(TABS[0]);\n\n  const onClick = useCallback(\n    tab => () => {\n      onChange(tab);\n      setTabEnabled(tab);\n    },\n    [onChange],\n  );\n\n  return (\n    <Container>\n      <h1>Annotation Type</h1>\n      {TABS.map(tab => (\n        <OptionBox key={tab} onClick={onClick(tab)} isPressed={tab === tabEnabled}>\n          {tab}\n        </OptionBox>\n      ))}\n    </Container>\n  );\n};\n\nconst Container = styled.div`\n  ${tw`flex py-2 w-full justify-center items-center`}\n  ${OptionBox.className} {\n    ${tw`mx-2`}\n  }\n`;\n\nexport default TypePicker;\n","import { OptionBox, TypePicker } from 'components';\nimport React, { useEffect, useMemo, useReducer, useState } from 'react';\nimport { className, LABEL_TYPE, ReactCanvasAnnotation } from 'react-canvas-annotation';\nimport styled from 'styled-components';\nimport 'tailwindcss/dist/base.css';\nimport tw from 'twin.macro';\nimport { generateEmpty, generateExample } from 'utils';\nimport image from './img.jpg';\n\nconst ZOOM_STEP = 0.1;\n\nconst App = () => {\n  const [labels, setLabels] = useState(generateEmpty());\n  const [annotationType, setAnnotationType] = useState(LABEL_TYPE.RECTANGLE);\n  const [imageFile, setImageFile] = useState(null);\n  const [isImageDrag, toggleDragMode] = useReducer(p => !p, false);\n\n  const [zoom, setZoom] = useState(1);\n\n  const zoomAction = useMemo(\n    () => ({\n      default: () => setZoom(1),\n      maxZoom: () => setZoom(2),\n      zoom: (isZoomIn = true) => () => setZoom(prev => prev + (isZoomIn ? 1 : -1) * ZOOM_STEP),\n    }),\n    [],\n  );\n\n  useEffect(() => {\n    const fetchImage = async () => {\n      const res = await fetch(image);\n      const buffer = await res.arrayBuffer();\n      const file = new File([buffer], `img.jpg`, { type: `image/jpg` });\n      setImageFile(file);\n    };\n    fetchImage();\n  }, []);\n\n  useEffect(() => {\n    console.log(labels);\n  }, [labels]);\n\n  const onControlledExample = () => setLabels(generateExample());\n  const onClean = () => setLabels(generateEmpty());\n\n  return (\n    <Container>\n      <TopActions>\n        <OptionBox onClick={zoomAction.zoom()}>Zoom In</OptionBox>\n        <OptionBox onClick={zoomAction.zoom(false)}>Zoom Out</OptionBox>\n        <OptionBox onClick={zoomAction.default}>Default Zoom</OptionBox>\n        <OptionBox onClick={zoomAction.maxZoom}>Zoom Max</OptionBox>\n        <OptionBox isPressed={isImageDrag} onClick={toggleDragMode} disabled={zoom === 1}>\n          Drag Image (Only on zoomed image)\n        </OptionBox>\n        <OptionBox onClick={onControlledExample}>Controlled State Example</OptionBox>\n        <OptionBox onClick={onClean}>Clean</OptionBox>\n      </TopActions>\n      {imageFile && (\n        <ReactCanvasAnnotation\n          zoom={zoom}\n          imageFile={imageFile}\n          labels={labels}\n          onChange={setLabels}\n          annotationType={annotationType}\n          isImageDrag={isImageDrag}\n        />\n      )}\n      <TypePicker onChange={setAnnotationType} />\n    </Container>\n  );\n};\n\nconst Container = styled.main`\n  ${tw`flex flex-col items-center justify-center overflow-hidden`}\n  > ${className} {\n    ${tw`border border-gray-500`}\n  }\n`;\n\nconst TopActions = styled.div`\n  ${tw`grid grid-flow-col gap-2 m-2`}\n`;\n\nexport default App;\n","export const generateExample = () => ({\n  labelRects: [\n    {\n      id: 'Rect-Example',\n      rect: {\n        x: 697.2371134020618,\n        y: 454.26804123711344,\n        width: 717.0309278350516,\n        height: 492.1237113402062,\n      },\n    },\n  ],\n  labelPolygons: [\n    {\n      id: `Poly-Example`,\n      vertices: [\n        { x: 623.7525773195875, y: 440.9072164948454 },\n        { x: 1331.8762886597938, y: 305.07216494845363 },\n        { x: 1641.4020618556701, y: 732.6185567010309 },\n        { x: 882.0618556701031, y: 790.5154639175258 },\n      ],\n    },\n  ],\n});\n\nexport const generateEmpty = () => ({\n  labelRects: [],\n  labelPolygons: [],\n});\n","import GlobalStyle from 'GlobalStyle.styles';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <>\n    <GlobalStyle />\n    <App />\n  </>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}